!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=14)}({14:function(e,t,n){"use strict";n.r(t);n(15)},15:function(e,t){!function(){"use strict";var e=tinymce.util.Tools.resolve("tinymce.PluginManager"),t=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]},n=function(e,t){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return e(t.apply(null,arguments))}},r=function(e){return function(){return e}},o=function(e){return e},i=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var r=new Array(arguments.length-1),o=1;o<arguments.length;o++)r[o-1]=arguments[o];return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var o=new Array(arguments.length),i=0;i<o.length;i++)o[i]=arguments[i];var u=r.concat(o);return e.apply(null,u)}},u=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return!e.apply(null,arguments)}},a=function(e){return e()},c=r(!1),l=r(!0),f=c,s=l,d=function(){return m},m=function(){var e=function(e){return e.isNone()},t=function(e){return e()},n=function(e){return e},o={fold:function(e,t){return e()},is:f,isSome:f,isNone:s,getOr:n,getOrThunk:t,getOrDie:function(e){throw new Error(e||"error: getOrDie called on none.")},getOrNull:function(){return null},getOrUndefined:function(){},or:n,orThunk:t,map:d,ap:d,each:function(){},bind:d,flatten:d,exists:f,forall:s,filter:d,equals:e,equals_:e,toArray:function(){return[]},toString:r("none()")};return Object.freeze&&Object.freeze(o),o}(),g=function(e){var t=function(){return e},n=function(){return o},r=function(t){return t(e)},o={fold:function(t,n){return n(e)},is:function(t){return e===t},isSome:s,isNone:f,getOr:t,getOrThunk:t,getOrDie:t,getOrNull:t,getOrUndefined:t,or:n,orThunk:n,map:function(t){return g(t(e))},ap:function(t){return t.fold(d,function(t){return g(t(e))})},each:function(t){t(e)},bind:r,flatten:t,exists:r,forall:r,filter:function(t){return t(e)?o:m},equals:function(t){return t.is(e)},equals_:function(t,n){return t.fold(f,function(t){return n(e,t)})},toArray:function(){return[e]},toString:function(){return"some("+e+")"}};return o},h={some:g,none:d,from:function(e){return null===e||void 0===e?m:g(e)}},p=function(e){return function(t){return function(e){if(null===e)return"null";var t=typeof e;return"object"===t&&Array.prototype.isPrototypeOf(e)?"array":"object"===t&&String.prototype.isPrototypeOf(e)?"string":t}(t)===e}},v=p("string"),b=p("array"),w=p("boolean"),y=p("function"),x=p("number"),C=function(){var e=Array.prototype.indexOf;return void 0===e?function(e,t){return P(e,t)}:function(t,n){return e.call(t,n)}}(),S=function(e,t){return C(e,t)>-1},R=function(e,t){return k(e,t).isSome()},T=function(e,t){for(var n=e.length,r=new Array(n),o=0;o<n;o++){var i=e[o];r[o]=t(i,o,e)}return r},N=function(e,t){for(var n=0,r=e.length;n<r;n++)t(e[n],n,e)},E=function(e,t){for(var n=[],r=0,o=e.length;r<o;r++){var i=e[r];t(i,r,e)&&n.push(i)}return n},D=function(e,t,n){return function(e,t){for(var n=e.length-1;n>=0;n--)t(e[n],n,e)}(e,function(e){n=t(n,e)}),n},O=function(e,t,n){return N(e,function(e){n=t(n,e)}),n},A=function(e,t){for(var n=0,r=e.length;n<r;n++){var o=e[n];if(t(o,n,e))return h.some(o)}return h.none()},k=function(e,t){for(var n=0,r=e.length;n<r;n++)if(t(e[n],n,e))return h.some(n);return h.none()},P=function(e,t){for(var n=0,r=e.length;n<r;++n)if(e[n]===t)return n;return-1},I=Array.prototype.push,B=function(e){for(var t=[],n=0,r=e.length;n<r;++n){if(!Array.prototype.isPrototypeOf(e[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+e);I.apply(t,e[n])}return t},W=function(e,t){var n=T(e,t);return B(n)},M=function(e,t){for(var n=0,r=e.length;n<r;++n)if(!0!==t(e[n],n,e))return!1;return!0},_=Array.prototype.slice,L=function(e){var t=_.call(e,0);return t.reverse(),t},j=(y(Array.from)&&Array.from,Object.keys),q=function(e,t){for(var n=j(e),r=0,o=n.length;r<o;r++){var i=n[r];t(e[i],i,e)}},F=function(e,t){return H(e,function(e,n,r){return{k:n,v:t(e,n,r)}})},H=function(e,t){var n={};return q(e,function(r,o){var i=t(r,o,e);n[i.k]=i.v}),n},z=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if(e.length!==t.length)throw new Error('Wrong number of arguments to struct. Expected "['+e.length+']", got '+t.length+" arguments");var o={};return N(e,function(e,n){o[e]=r(t[n])}),o}},U=function(e){return e.slice(0).sort()},V=function(e,t){throw new Error("All required keys ("+U(e).join(", ")+") were not specified. Specified keys were: "+U(t).join(", ")+".")},G=function(e){throw new Error("Unsupported keys for object: "+U(e).join(", "))},Y=function(e,t){if(!b(t))throw new Error("The "+e+" fields must be an array. Was: "+t+".");N(t,function(t){if(!v(t))throw new Error("The value "+t+" in the "+e+" fields was not a string.")})},X=function(e){var t=U(e);A(t,function(e,n){return n<t.length-1&&e===t[n+1]}).each(function(e){throw new Error("The field: "+e+" occurs more than once in the combined fields: ["+t.join(", ")+"].")})},K=function(e,t){var n=e.concat(t);if(0===n.length)throw new Error("You must specify at least one required or optional field.");return Y("required",e),Y("optional",t),X(n),function(o){var i=j(o);M(e,function(e){return S(i,e)})||V(e,i);var u=E(i,function(e){return!S(n,e)});u.length>0&&G(u);var a={};return N(e,function(e){a[e]=r(o[e])}),N(t,function(e){a[e]=r(Object.prototype.hasOwnProperty.call(o,e)?h.some(o[e]):h.none())}),a}},J=z("width","height"),$=z("rows","columns"),Q=z("row","column"),Z=z("x","y"),ee=z("element","rowspan","colspan"),te=z("element","rowspan","colspan","isNew"),ne={dimensions:J,grid:$,address:Q,coords:Z,extended:z("element","rowspan","colspan","row","column"),detail:ee,detailnew:te,rowdata:z("element","cells","section"),elementnew:z("element","isNew"),rowdatanew:z("element","cells","section","isNew"),rowcells:z("cells","section"),rowdetails:z("details","section"),bounds:z("startRow","startCol","finishRow","finishCol")},re=function(e){if(null===e||void 0===e)throw new Error("Node cannot be null or undefined");return{dom:r(e)}},oe={fromHtml:function(e,t){var n=(t||document).createElement("div");if(n.innerHTML=e,!n.hasChildNodes()||n.childNodes.length>1)throw console.error("HTML does not have a single root node",e),"HTML must have a single root node";return re(n.childNodes[0])},fromTag:function(e,t){var n=(t||document).createElement(e);return re(n)},fromText:function(e,t){var n=(t||document).createTextNode(e);return re(n)},fromDom:re,fromPoint:function(e,t,n){var r=e.dom();return h.from(r.elementFromPoint(t,n)).map(re)}},ie={ATTRIBUTE:Node.ATTRIBUTE_NODE,CDATA_SECTION:Node.CDATA_SECTION_NODE,COMMENT:Node.COMMENT_NODE,DOCUMENT:Node.DOCUMENT_NODE,DOCUMENT_TYPE:Node.DOCUMENT_TYPE_NODE,DOCUMENT_FRAGMENT:Node.DOCUMENT_FRAGMENT_NODE,ELEMENT:Node.ELEMENT_NODE,TEXT:Node.TEXT_NODE,PROCESSING_INSTRUCTION:Node.PROCESSING_INSTRUCTION_NODE,ENTITY_REFERENCE:Node.ENTITY_REFERENCE_NODE,ENTITY:Node.ENTITY_NODE,NOTATION:Node.NOTATION_NODE},ue=ie.ELEMENT,ae=ie.DOCUMENT,ce=function(e){return e.nodeType!==ue&&e.nodeType!==ae||0===e.childElementCount},le={all:function(e,t){var n=void 0===t?document:t.dom();return ce(n)?[]:T(n.querySelectorAll(e),oe.fromDom)},is:function(e,t){var n=e.dom();if(n.nodeType!==ue)return!1;if(void 0!==n.matches)return n.matches(t);if(void 0!==n.msMatchesSelector)return n.msMatchesSelector(t);if(void 0!==n.webkitMatchesSelector)return n.webkitMatchesSelector(t);if(void 0!==n.mozMatchesSelector)return n.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")},one:function(e,t){var n=void 0===t?document:t.dom();return ce(n)?h.none():h.from(n.querySelector(e)).map(oe.fromDom)}},fe=function(e,t){var n=[],r=function(e){return n.push(e),t(e)},o=t(e);do{o=o.bind(r)}while(o.isSome());return n},se="undefined"!=typeof window?window:Function("return this;")(),de=function(e,t){return function(e,t){for(var n=void 0!==t&&null!==t?t:se,r=0;r<e.length&&void 0!==n&&null!==n;++r)n=n[e[r]];return n}(e.split("."),t)},me=function(e,t){var n=function(e,t){return de(e,t)}(e,t);if(void 0===n||null===n)throw e+" not available on this browser";return n},ge=function(){return me("Node")},he=function(e,t,n){return 0!=(e.compareDocumentPosition(t)&n)},pe=function(e,t){return he(e,t,ge().DOCUMENT_POSITION_CONTAINED_BY)},ve=function(e){var t,n=!1;return function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];return n||(n=!0,t=e.apply(null,r)),t}},be=function(){return we(0,0)},we=function(e,t){return{major:e,minor:t}},ye={nu:we,detect:function(e,t){var n=String(t).toLowerCase();return 0===e.length?be():function(e,t){var n=function(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(r.test(t))return r}}(e,t);if(!n)return{major:0,minor:0};var r=function(e){return Number(t.replace(n,"$"+e))};return we(r(1),r(2))}(e,n)},unknown:be},xe=function(e,t){return function(){return t===e}},Ce=function(e){var t=e.current;return{current:t,version:e.version,isEdge:xe("Edge",t),isChrome:xe("Chrome",t),isIE:xe("IE",t),isOpera:xe("Opera",t),isFirefox:xe("Firefox",t),isSafari:xe("Safari",t)}},Se={unknown:function(){return Ce({current:void 0,version:ye.unknown()})},nu:Ce,edge:r("Edge"),chrome:r("Chrome"),ie:r("IE"),opera:r("Opera"),firefox:r("Firefox"),safari:r("Safari")},Re=function(e,t){return function(){return t===e}},Te=function(e){var t=e.current;return{current:t,version:e.version,isWindows:Re("Windows",t),isiOS:Re("iOS",t),isAndroid:Re("Android",t),isOSX:Re("OSX",t),isLinux:Re("Linux",t),isSolaris:Re("Solaris",t),isFreeBSD:Re("FreeBSD",t)}},Ne={unknown:function(){return Te({current:void 0,version:ye.unknown()})},nu:Te,windows:r("Windows"),ios:r("iOS"),android:r("Android"),linux:r("Linux"),osx:r("OSX"),solaris:r("Solaris"),freebsd:r("FreeBSD")},Ee=function(e,t){var n=String(t).toLowerCase();return A(e,function(e){return e.search(n)})},De=function(e,t){return Ee(e,t).map(function(e){var n=ye.detect(e.versionRegexes,t);return{current:e.name,version:n}})},Oe=function(e,t){return Ee(e,t).map(function(e){var n=ye.detect(e.versionRegexes,t);return{current:e.name,version:n}})},Ae=function(e,t){return-1!==e.indexOf(t)},ke=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,Pe=function(e){return function(t){return Ae(t,e)}},Ie=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(e){return Ae(e,"edge/")&&Ae(e,"chrome")&&Ae(e,"safari")&&Ae(e,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,ke],search:function(e){return Ae(e,"chrome")&&!Ae(e,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(e){return Ae(e,"msie")||Ae(e,"trident")}},{name:"Opera",versionRegexes:[ke,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:Pe("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:Pe("firefox")},{name:"Safari",versionRegexes:[ke,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(e){return(Ae(e,"safari")||Ae(e,"mobile/"))&&Ae(e,"applewebkit")}}],Be=[{name:"Windows",search:Pe("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(e){return Ae(e,"iphone")||Ae(e,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:Pe("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:Pe("os x"),versionRegexes:[/.*?os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:Pe("linux"),versionRegexes:[]},{name:"Solaris",search:Pe("sunos"),versionRegexes:[]},{name:"FreeBSD",search:Pe("freebsd"),versionRegexes:[]}],We={browsers:r(Ie),oses:r(Be)},Me=function(e){var t=We.browsers(),n=We.oses(),o=De(t,e).fold(Se.unknown,Se.nu),i=Oe(n,e).fold(Ne.unknown,Ne.nu);return{browser:o,os:i,deviceType:function(e,t,n){var o=e.isiOS()&&!0===/ipad/i.test(n),i=e.isiOS()&&!o,u=e.isAndroid()&&3===e.version.major,a=e.isAndroid()&&4===e.version.major,c=o||u||a&&!0===/mobile/i.test(n),l=e.isiOS()||e.isAndroid(),f=l&&!c,s=t.isSafari()&&e.isiOS()&&!1===/safari/i.test(n);return{isiPad:r(o),isiPhone:r(i),isTablet:r(c),isPhone:r(f),isTouch:r(l),isAndroid:e.isAndroid,isiOS:e.isiOS,isWebView:r(s)}}(i,o,e)}},_e={detect:ve(function(){var e=navigator.userAgent;return Me(e)})},Le=function(e,t){return e.dom()===t.dom()},je=_e.detect().browser.isIE()?function(e,t){return pe(e.dom(),t.dom())}:function(e,t){var n=e.dom(),r=t.dom();return n!==r&&n.contains(r)},qe={eq:Le,isEqualNode:function(e,t){return e.dom().isEqualNode(t.dom())},member:function(e,t){return R(t,i(Le,e))},contains:je,is:le.is},Fe=function(e){var t=e.dom();return h.from(t.parentNode).map(oe.fromDom)},He=function(e){var t=e.dom();return h.from(t.previousSibling).map(oe.fromDom)},ze=function(e){var t=e.dom();return h.from(t.nextSibling).map(oe.fromDom)},Ue=function(e){var t=e.dom();return T(t.childNodes,oe.fromDom)},Ve=function(e,t){var n=e.dom().childNodes;return h.from(n[t]).map(oe.fromDom)},Ge=z("element","offset"),Ye={owner:function(e){return oe.fromDom(e.dom().ownerDocument)},defaultView:function(e){var t=e.dom().ownerDocument.defaultView;return oe.fromDom(t)},documentElement:function(e){return oe.fromDom(e.dom().ownerDocument.documentElement)},parent:Fe,findIndex:function(e){return Fe(e).bind(function(t){var n=Ue(t);return k(n,function(t){return qe.eq(e,t)})})},parents:function(e,t){for(var n=y(t)?t:r(!1),o=e.dom(),i=[];null!==o.parentNode&&void 0!==o.parentNode;){var u=o.parentNode,a=oe.fromDom(u);if(i.push(a),!0===n(a))break;o=u}return i},siblings:function(e){return Fe(e).map(Ue).map(function(t){return E(t,function(t){return!qe.eq(e,t)})}).getOr([])},prevSibling:He,offsetParent:function(e){var t=e.dom();return h.from(t.offsetParent).map(oe.fromDom)},prevSiblings:function(e){return L(fe(e,He))},nextSibling:ze,nextSiblings:function(e){return fe(e,ze)},children:Ue,child:Ve,firstChild:function(e){return Ve(e,0)},lastChild:function(e){return Ve(e,e.dom().childNodes.length-1)},childNodesCount:function(e){return e.dom().childNodes.length},hasChildNodes:function(e){return e.dom().hasChildNodes()},leaf:function(e,t){var n=Ue(e);return n.length>0&&t<n.length?Ge(n[t],0):Ge(e,t)}},Xe=function(e,t,n){return W(Ye.children(e),function(e){return le.is(e,t)?n(e)?[e]:[]:Xe(e,t,n)})},Ke={firstLayer:function(e,t){return Xe(e,t,r(!0))},filterFirstLayer:Xe},Je=function(e){return e.dom().nodeName.toLowerCase()},$e=function(e){return e.dom().nodeType},Qe=function(e){return function(t){return $e(t)===e}},Ze=Qe(ie.ELEMENT),et=Qe(ie.TEXT),tt=Qe(ie.DOCUMENT),nt={name:Je,type:$e,value:function(e){return e.dom().nodeValue},isElement:Ze,isText:et,isDocument:tt,isComment:function(e){return $e(e)===ie.COMMENT||"#comment"===Je(e)}},rt=function(e,t,n){if(!(v(n)||w(n)||x(n)))throw console.error("Invalid call to Attr.set. Key ",t,":: Value ",n,":: Element ",e),new Error("Attribute value was not simple");e.setAttribute(t,n+"")},ot=function(e,t,n){rt(e.dom(),t,n)},it=function(e,t){var n=e.dom().getAttribute(t);return null===n?void 0:n},ut=function(e,t){var n=e.dom();return!(!n||!n.hasAttribute)&&n.hasAttribute(t)},at={clone:function(e){return O(e.dom().attributes,function(e,t){return e[t.name]=t.value,e},{})},set:ot,setAll:function(e,t){var n=e.dom();q(t,function(e,t){rt(n,t,e)})},get:it,has:ut,remove:function(e,t){e.dom().removeAttribute(t)},hasNone:function(e){var t=e.dom().attributes;return void 0===t||null===t||0===t.length},transfer:function(e,t,n){nt.isElement(e)&&nt.isElement(t)&&N(n,function(n){!function(e,t,n){ut(e,n)&&!ut(t,n)&&ot(t,n,it(e,n))}(e,t,n)})}},ct=ve(function(){return lt(oe.fromDom(document))}),lt=function(e){var t=e.dom().body;if(null===t||void 0===t)throw"Body is not available yet";return oe.fromDom(t)},ft={body:ct,getBody:lt,inBody:function(e){var t=nt.isText(e)?e.dom().parentNode:e.dom();return void 0!==t&&null!==t&&t.ownerDocument.body.contains(t)}},st=function(e,t){var n=[];return N(Ye.children(e),function(e){t(e)&&(n=n.concat([e])),n=n.concat(st(e,t))}),n},dt={all:function(e){return st(ft.body(),e)},ancestors:function(e,t,n){return E(Ye.parents(e,n),t)},siblings:function(e,t){return E(Ye.siblings(e),t)},children:function(e,t){return E(Ye.children(e),t)},descendants:st},mt={all:function(e){return le.all(e)},ancestors:function(e,t,n){return dt.ancestors(e,function(e){return le.is(e,t)},n)},siblings:function(e,t){return dt.siblings(e,function(e){return le.is(e,t)})},children:function(e,t){return dt.children(e,function(e){return le.is(e,t)})},descendants:function(e,t){return le.all(t,e)}};function gt(e,t,n,r,o){return e(n,r)?h.some(n):y(o)&&o(n)?h.none():t(n,r,o)}var ht=function(e,t,n){for(var o=e.dom(),i=y(n)?n:r(!1);o.parentNode;){o=o.parentNode;var u=oe.fromDom(o);if(t(u))return h.some(u);if(i(u))break}return h.none()},pt=function(e,t){return A(e.dom().childNodes,n(t,oe.fromDom)).map(oe.fromDom)},vt=function(e,t){var n=function(e){for(var r=0;r<e.childNodes.length;r++){if(t(oe.fromDom(e.childNodes[r])))return h.some(oe.fromDom(e.childNodes[r]));var o=n(e.childNodes[r]);if(o.isSome())return o}return h.none()};return n(e.dom())},bt={first:function(e){return vt(ft.body(),e)},ancestor:ht,closest:function(e,t,n){return gt(function(e){return t(e)},ht,e,t,n)},sibling:function(e,t){var n=e.dom();return n.parentNode?pt(oe.fromDom(n.parentNode),function(n){return!qe.eq(e,n)&&t(n)}):h.none()},child:pt,descendant:vt},wt=function(e,t,n){return bt.ancestor(e,function(e){return le.is(e,t)},n)},yt={first:function(e){return le.one(e)},ancestor:wt,sibling:function(e,t){return bt.sibling(e,function(e){return le.is(e,t)})},child:function(e,t){return bt.child(e,function(e){return le.is(e,t)})},descendant:function(e,t){return le.one(t,e)},closest:function(e,t,n){return gt(le.is,wt,e,t,n)}},xt=function(e,t,n){var o=void 0!==n?n:r(!1);return o(t)?h.none():S(e,nt.name(t))?h.some(t):yt.ancestor(t,e.join(","),function(e){return le.is(e,"table")||o(e)})},Ct=function(e,t){return Ye.parent(t).map(function(t){return mt.children(t,e)})},St=function(e,t){return parseInt(at.get(e,t),10)},Rt={cell:function(e,t){return xt(["td","th"],e,t)},firstCell:function(e){return yt.descendant(e,"th,td")},cells:function(e){return Ke.firstLayer(e,"th,td")},neighbourCells:i(Ct,"th,td"),table:function(e,t){return yt.closest(e,"table",t)},row:function(e,t){return xt(["tr"],e,t)},rows:function(e){return Ke.firstLayer(e,"tr")},notCell:function(e,t){return xt(["caption","tr","tbody","tfoot","thead"],e,t)},neighbourRows:i(Ct,"tr"),attr:St,grid:function(e,t,n){var r=St(e,t),o=St(e,n);return ne.grid(r,o)}},Tt=function(e){var t=Rt.rows(e);return T(t,function(e){var t=e,n=Ye.parent(t).map(function(e){var t=nt.name(e);return"tfoot"===t||"thead"===t||"tbody"===t?t:"tbody"}).getOr("tbody"),r=T(Rt.cells(e),function(e){var t=at.has(e,"rowspan")?parseInt(at.get(e,"rowspan"),10):1,n=at.has(e,"colspan")?parseInt(at.get(e,"colspan"),10):1;return ne.detail(e,t,n)});return ne.rowdata(t,r,n)})},Nt=function(e,t){return T(e,function(e){var n=T(Rt.cells(e),function(e){var t=at.has(e,"rowspan")?parseInt(at.get(e,"rowspan"),10):1,n=at.has(e,"colspan")?parseInt(at.get(e,"colspan"),10):1;return ne.detail(e,t,n)});return ne.rowdata(e,n,t.section())})},Et=function(e,t){return e+","+t},Dt=function(e,t){var n=W(e.all(),function(e){return e.cells()});return E(n,t)},Ot={generate:function(e){var t={},n=[],o=e.length,i=0;N(e,function(e,r){var o=[];N(e.cells(),function(e,n){for(var u=0;void 0!==t[Et(r,u)];)u++;for(var a=ne.extended(e.element(),e.rowspan(),e.colspan(),r,u),c=0;c<e.colspan();c++)for(var l=0;l<e.rowspan();l++){var f=u+c,s=Et(r+l,f);t[s]=a,i=Math.max(i,f+1)}o.push(a)}),n.push(ne.rowdata(e.element(),o,e.section()))});var u=ne.grid(o,i);return{grid:r(u),access:r(t),all:r(n)}},getAt:function(e,t,n){var r=e.access()[Et(t,n)];return void 0!==r?h.some(r):h.none()},findItem:function(e,t,n){var r=Dt(e,function(e){return n(t,e.element())});return r.length>0?h.some(r[0]):h.none()},filterItems:Dt,justCells:function(e){var t=T(e.all(),function(e){return e.cells()});return B(t)}},At={isSupported:function(e){return void 0!==e.style}},kt=function(e,t,n){if(!v(n))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",n,":: Element ",e),new Error("CSS value must be a string: "+n);At.isSupported(e)&&e.style.setProperty(t,n)},Pt=function(e,t){At.isSupported(e)&&e.style.removeProperty(t)},It=function(e,t,n){var r=e.dom();kt(r,t,n)},Bt=function(e,t){return At.isSupported(e)?e.style.getPropertyValue(t):""},Wt=function(e,t){var n=e.dom(),r=Bt(n,t);return h.from(r).filter(function(e){return e.length>0})},Mt={copy:function(e,t){var n=e.dom(),r=t.dom();At.isSupported(n)&&At.isSupported(r)&&(r.style.cssText=n.style.cssText)},set:It,preserve:function(e,t){var n=at.get(e,"style"),r=t(e);return(void 0===n?at.remove:at.set)(e,"style",n),r},setAll:function(e,t){var n=e.dom();q(t,function(e,t){kt(n,t,e)})},setOptions:function(e,t){var n=e.dom();q(t,function(e,t){e.fold(function(){Pt(n,t)},function(e){kt(n,t,e)})})},remove:function(e,t){var n=e.dom();Pt(n,t),at.has(e,"style")&&""===function(e){return e.replace(/^\s+|\s+$/g,"")}(at.get(e,"style"))&&at.remove(e,"style")},get:function(e,t){var n=e.dom(),r=window.getComputedStyle(n).getPropertyValue(t),o=""!==r||ft.inBody(e)?r:Bt(n,t);return null===o?void 0:o},getRaw:Wt,getAllRaw:function(e){var t={},n=e.dom();if(At.isSupported(n))for(var r=0;r<n.style.length;r++){var o=n.style.item(r);t[o]=n.style[o]}return t},isValidValue:function(e,t,n){var r=oe.fromTag(e);return It(r,t,n),Wt(r,t).isSome()},reflow:function(e){return e.dom().offsetWidth},transfer:function(e,t,n){nt.isElement(e)&&nt.isElement(t)&&N(n,function(n){!function(e,t,n){Wt(e,n).each(function(e){Wt(t,n).isNone()&&It(t,n,e)})}(e,t,n)})}},_t=function(e,t){Ye.parent(e).each(function(n){n.dom().insertBefore(t.dom(),e.dom())})},Lt=function(e,t){e.dom().appendChild(t.dom())},jt={before:_t,after:function(e,t){Ye.nextSibling(e).fold(function(){Ye.parent(e).each(function(e){Lt(e,t)})},function(e){_t(e,t)})},prepend:function(e,t){Ye.firstChild(e).fold(function(){Lt(e,t)},function(n){e.dom().insertBefore(t.dom(),n.dom())})},append:Lt,appendAt:function(e,t,n){Ye.child(e,n).fold(function(){Lt(e,t)},function(e){_t(e,t)})},wrap:function(e,t){_t(e,t),Lt(t,e)}},qt={before:function(e,t){N(t,function(t){jt.before(e,t)})},after:function(e,t){N(t,function(n,r){var o=0===r?e:t[r-1];jt.after(o,n)})},prepend:function(e,t){N(t.slice().reverse(),function(t){jt.prepend(e,t)})},append:function(e,t){N(t,function(t){jt.append(e,t)})}},Ft=function(e){var t=e.dom();null!==t.parentNode&&t.parentNode.removeChild(t)},Ht={empty:function(e){e.dom().textContent="",N(Ye.children(e),function(e){Ft(e)})},remove:Ft,unwrap:function(e){var t=Ye.children(e);t.length>0&&qt.before(e,t),Ft(e)}},zt=z("minRow","minCol","maxRow","maxCol"),Ut=function(e,t){var n=e.grid().columns(),r=e.grid().rows(),o=n,i=0,u=0;return q(e.access(),function(e){if(t(e)){var n=e.row(),a=n+e.rowspan()-1,c=e.column(),l=c+e.colspan()-1;n<r?r=n:a>i&&(i=a),c<o?o=c:l>u&&(u=l)}}),zt(r,o,i,u)},Vt=function(e,t,n){var r=e[n].element(),o=oe.fromTag("td");jt.append(o,oe.fromTag("br")),(t?jt.append:jt.prepend)(r,o)},Gt=function(e,t){var n=function(e){return le.is(e.element(),t)},r=Tt(e),o=Ot.generate(r),i=Ut(o,n),u="th:not("+t+"),td:not("+t+")",a=Ke.filterFirstLayer(e,"th,td",function(e){return le.is(e,u)});return N(a,Ht.remove),function(e,t,n,r){for(var o=t.grid().columns(),i=t.grid().rows(),u=0;u<i;u++)for(var a=!1,c=0;c<o;c++)u<n.minRow()||u>n.maxRow()||c<n.minCol()||c>n.maxCol()||(Ot.getAt(t,u,c).filter(r).isNone()?Vt(e,a,u):a=!0)}(r,o,i,n),function(e,t){var n=E(Ke.firstLayer(e,"tr"),function(e){return 0===e.dom().childElementCount});N(n,Ht.remove),t.minCol()!==t.maxCol()&&t.minRow()!==t.maxRow()||N(Ke.firstLayer(e,"th,td"),function(e){at.remove(e,"rowspan"),at.remove(e,"colspan")}),at.remove(e,"width"),at.remove(e,"height"),Mt.remove(e,"width"),Mt.remove(e,"height")}(e,i),e},Yt=function(e,t){return oe.fromDom(e.dom().cloneNode(t))},Xt=function(e){return Yt(e,!0)},Kt=function(e,t){var n=oe.fromTag(t),r=at.clone(e);return at.setAll(n,r),n},Jt=function(e){return Yt(e,!1)},$t=Xt,Qt=function(e,t){var n=Kt(e,t),r=Ye.children(Xt(e));return qt.append(n,r),n},Zt=function(e,t){var n=function(t){return e(t)?h.from(t.dom().nodeValue):h.none()},r=_e.detect().browser,o=r.isIE()&&10===r.version.major?function(e){try{return n(e)}catch(e){return h.none()}}:n;return{get:function(n){if(!e(n))throw new Error("Can only get "+t+" value of a "+t+" node");return o(n).getOr("")},getOption:o,set:function(n,r){if(!e(n))throw new Error("Can only set raw "+t+" value of a "+t+" node");n.dom().nodeValue=r}}}(nt.isText,"text"),en={get:function(e){return Zt.get(e)},getOption:function(e){return Zt.getOption(e)},set:function(e,t){Zt.set(e,t)}},tn=function(e){return"img"===nt.name(e)?1:en.getOption(e).fold(function(){return Ye.children(e).length},function(e){return e.length})},nn=["img","br"],rn=tn,on=function(e){return function(e){return en.getOption(e).filter(function(e){return 0!==e.trim().length||e.indexOf("Â ")>-1}).isSome()}(e)||S(nn,nt.name(e))},un=function(e,t){var n=function(e){for(var r=Ye.children(e),o=r.length-1;o>=0;o--){var i=r[o];if(t(i))return h.some(i);var u=n(i);if(u.isSome())return u}return h.none()};return n(e)},an={first:function(e){return bt.descendant(e,on)},last:function(e){return un(e,on)}},cn=function(){var e=oe.fromTag("td");return jt.append(e,oe.fromTag("br")),e},ln=function(e,t,n){var r=Qt(e,t);return q(n,function(e,t){null===e?at.remove(r,t):at.set(r,t,e)}),r},fn=function(e){return e},sn=function(e){return function(){return oe.fromTag("tr",e.dom())}},dn=function(e,t,n){return{row:sn(t),cell:function(t){var r=Ye.owner(t.element()),o=oe.fromTag(nt.name(t.element()),r.dom()),i=n.getOr(["strong","em","b","i","span","font","h1","h2","h3","h4","h5","h6","p","div"]),u=i.length>0?function(e,t,n){return an.first(e).map(function(r){var o=n.join(","),i=mt.ancestors(r,o,function(t){return qe.eq(t,e)});return D(i,function(e,t){var n=Jt(t);return at.remove(n,"contenteditable"),jt.append(e,n),n},t)}).getOr(t)}(t.element(),o,i):o;return jt.append(u,oe.fromTag("br")),Mt.copy(t.element(),o),Mt.remove(o,"height"),1!==t.colspan()&&Mt.remove(t.element(),"width"),e(t.element(),o),o},replace:ln,gap:cn}},mn=function(e){return{row:sn(e),cell:cn,replace:fn,gap:cn}},gn=function(e,t){var n=(t||document).createElement("div");return n.innerHTML=e,Ye.children(oe.fromDom(n))},hn=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","li","table","thead","tbody","tfoot","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"];function pn(){return{up:r({selector:yt.ancestor,closest:yt.closest,predicate:bt.ancestor,all:Ye.parents}),down:r({selector:mt.descendants,predicate:dt.descendants}),styles:r({get:Mt.get,getRaw:Mt.getRaw,set:Mt.set,remove:Mt.remove}),attrs:r({get:at.get,set:at.set,remove:at.remove,copyTo:function(e,t){var n=at.clone(e);at.setAll(t,n)}}),insert:r({before:jt.before,after:jt.after,afterAll:qt.after,append:jt.append,appendAll:qt.append,prepend:jt.prepend,wrap:jt.wrap}),remove:r({unwrap:Ht.unwrap,remove:Ht.remove}),create:r({nu:oe.fromTag,clone:function(e){return oe.fromDom(e.dom().cloneNode(!1))},text:oe.fromText}),query:r({comparePosition:function(e,t){return e.dom().compareDocumentPosition(t.dom())},prevSibling:Ye.prevSibling,nextSibling:Ye.nextSibling}),property:r({children:Ye.children,name:nt.name,parent:Ye.parent,isText:nt.isText,isComment:nt.isComment,isElement:nt.isElement,getText:en.get,setText:en.set,isBoundary:function(e){return!!nt.isElement(e)&&("body"===nt.name(e)||S(hn,nt.name(e)))},isEmptyTag:function(e){return!!nt.isElement(e)&&S(["br","img","hr","input"],nt.name(e))}}),eq:qe.eq,is:qe.is}}var vn=z("left","right"),bn=function(e,t,n){var o=e.property().children(t);return k(o,i(e.eq,n)).map(function(e){return{before:r(o.slice(0,e)),after:r(o.slice(e+1))}})},wn=function(e,t,n){return bn(e,t,n).map(function(r){var o=e.create().clone(t);return e.insert().appendAll(o,r.before().concat([n])),e.insert().appendAll(t,r.after()),e.insert().before(t,o),vn(o,t)})},yn=function(e,t,n){return bn(e,t,n).map(function(n){var r=e.create().clone(t);return e.insert().appendAll(r,n.after()),e.insert().after(t,r),vn(t,r)})},xn=function(e,t,n,r){var o=z("first","second","splits"),i=function(t,u,a){var c=o(t,h.none(),a);return n(t)?o(t,u,a):e.property().parent(t).bind(function(o){return r(e,o,t).map(function(e){var t=[{first:e.left,second:e.right}],r=n(o)?o:e.left();return i(r,h.some(e.right()),a.concat(t))}).getOr(c)})};return i(t,h.none(),[])},Cn=function(e,t,n,r){var o=t(e,n);return D(r,function(n,r){var o=t(e,r);return Sn(e,n,o)},o)},Sn=function(e,t,n){return t.bind(function(t){return n.filter(i(e.eq,t))})},Rn=function(e,t,n){return n.length>0?function(e,t,n,r){return r(e,t,n[0],n.slice(1))}(e,t,n,Cn):h.none()},Tn=function(e,t){return i(e.eq,t)},Nn=function(e,t,n,o){var i=void 0!==o?o:r(!1),u=[t].concat(e.up().all(t)),a=[n].concat(e.up().all(n)),c=function(e){return k(e,i).fold(function(){return e},function(t){return e.slice(0,t+1)})},l=c(u),f=c(a),s=A(l,function(t){return R(f,Tn(e,t))});return{firstpath:r(l),secondpath:r(f),shared:r(s)}},En=function(e,t,n){var r=Nn(e,t,n);return r.shared().bind(function(t){return function(e,t,n,r){var o=e.property().children(t);if(e.eq(t,n[0]))return h.some([n[0]]);if(e.eq(t,r[0]))return h.some([r[0]]);var i=function(n){var r=L(n),i=k(r,Tn(e,t)).getOr(-1),u=i<r.length-1?r[i+1]:r[i];return k(o,Tn(e,u))},u=i(n),a=i(r);return u.bind(function(e){return a.map(function(t){var n=Math.min(e,t),r=Math.max(e,t);return o.slice(n,r+1)})})}(e,t,r.firstpath(),r.secondpath())})},Dn=Nn,On=function(e,t,n){return Rn(e,t,n)},An=function(e,t,n){return En(e,t,n)},kn=function(e,t,n,r){return Dn(e,t,n,r)},Pn=function(e,t,n){return wn(e,t,n)},In=function(e,t,n){return yn(e,t,n)},Bn=function(e,t,n,r){return xn(e,t,n,r)},Wn=pn(),Mn={sharedOne:function(e,t){return On(Wn,function(t,n){return e(n)},t)},subset:function(e,t){return An(Wn,e,t)},ancestors:function(e,t,n){return kn(Wn,e,t,n)},breakToLeft:function(e,t){return Pn(Wn,e,t)},breakToRight:function(e,t){return In(Wn,e,t)},breakPath:function(e,t,n){return Bn(Wn,e,t,function(e,t,r){return n(t,r)})}},_n=function(e,t){return t.column()>=e.startCol()&&t.column()+t.colspan()-1<=e.finishCol()&&t.row()>=e.startRow()&&t.row()+t.rowspan()-1<=e.finishRow()},Ln=function(e,t){var n=t.column(),r=t.column()+t.colspan()-1,o=t.row(),i=t.row()+t.rowspan()-1;return n<=e.finishCol()&&r>=e.startCol()&&o<=e.finishRow()&&i>=e.startRow()},jn=function(e,t){for(var n=!0,r=i(_n,t),o=t.startRow();o<=t.finishRow();o++)for(var u=t.startCol();u<=t.finishCol();u++)n=n&&Ot.getAt(e,o,u).exists(r);return n?h.some(t):h.none()},qn=function(e,t,n){var r=Ot.findItem(e,t,qe.eq),o=Ot.findItem(e,n,qe.eq);return r.bind(function(e){return o.map(function(t){return function(e,t){return ne.bounds(Math.min(e.row(),t.row()),Math.min(e.column(),t.column()),Math.max(e.row()+e.rowspan()-1,t.row()+t.rowspan()-1),Math.max(e.column()+e.colspan()-1,t.column()+t.colspan()-1))}(e,t)})})},Fn=qn,Hn=function(e,t,n){return qn(e,t,n).bind(function(t){return jn(e,t)})},zn=function(e,t,n,r){return Ot.findItem(e,t,qe.eq).bind(function(t){var o=n>0?t.row()+t.rowspan()-1:t.row(),i=r>0?t.column()+t.colspan()-1:t.column();return Ot.getAt(e,o+n,i+r).map(function(e){return e.element()})})},Un=function(e,t,n){return Fn(e,t,n).map(function(t){var n=Ot.filterItems(e,i(Ln,t));return T(n,function(e){return e.element()})})},Vn=function(e,t){return Ot.findItem(e,t,function(e,t){return qe.contains(t,e)}).bind(function(e){return e.element()})},Gn=function(e){var t=Tt(e);return Ot.generate(t)},Yn=function(e,t,n){return Rt.table(e).bind(function(r){var o=Gn(r);return zn(o,e,t,n)})},Xn=function(e,t,n){var r=Gn(e);return Un(r,t,n)},Kn=function(e,t,n,r,o){var i=Gn(e),u=qe.eq(e,n)?t:Vn(i,t),a=qe.eq(e,o)?r:Vn(i,r);return Un(i,u,a)},Jn=function(e,t,n){var r=Gn(e);return Hn(r,t,n)},$n=function(e,t){return yt.ancestor(e,"table")},Qn=K(["boxes","start","finish"],[]),Zn=function(e,t,n){var r=function(e){return function(t){return n(t)||qe.eq(t,e)}};return qe.eq(e,t)?h.some(Qn({boxes:h.some([e]),start:e,finish:t})):$n(e).bind(function(o){return $n(t).bind(function(i){if(qe.eq(o,i))return h.some(Qn({boxes:Xn(o,e,t),start:e,finish:t}));if(qe.contains(o,i)){var u=(a=mt.ancestors(t,"td,th",r(o))).length>0?a[a.length-1]:t;return h.some(Qn({boxes:Kn(o,e,o,t,i),start:e,finish:u}))}if(qe.contains(i,o)){var a,c=(a=mt.ancestors(e,"td,th",r(i))).length>0?a[a.length-1]:e;return h.some(Qn({boxes:Kn(i,e,o,t,i),start:e,finish:c}))}return Mn.ancestors(e,t).shared().bind(function(u){return yt.closest(u,"table",n).bind(function(n){var u=mt.ancestors(t,"td,th",r(n)),a=u.length>0?u[u.length-1]:t,c=mt.ancestors(e,"td,th",r(n)),l=c.length>0?c[c.length-1]:e;return h.some(Qn({boxes:Kn(n,e,o,t,i),start:l,finish:a}))})})})})},er={identify:Zn,retrieve:function(e,t){var n=mt.descendants(e,t);return n.length>0?h.some(n):h.none()},shiftSelection:function(e,t,n,o,i){return function(e,t){return A(e,function(e){return le.is(e,t)})}(e,i).bind(function(e){return Yn(e,t,n).bind(function(e){return function(e,t){return yt.ancestor(e,"table").bind(function(n){return yt.descendant(n,t).bind(function(t){return Zn(t,e).bind(function(e){return e.boxes().map(function(t){return{boxes:r(t),start:r(e.start()),finish:r(e.finish())}})})})})}(e,o)})})},getEdges:function(e,t,n){return yt.descendant(e,t).bind(function(t){return yt.descendant(e,n).bind(function(e){return Mn.sharedOne($n,[t,e]).map(function(n){return{first:r(t),last:r(e),table:r(n)}})})})}},tr=function(e,t){return er.retrieve(e,t)},nr=function(e,t,n){return er.getEdges(e,t,n).bind(function(t){var n=function(t){return qe.eq(e,t)},r=yt.ancestor(t.first(),"thead,tfoot,tbody,table",n),o=yt.ancestor(t.last(),"thead,tfoot,tbody,table",n);return r.bind(function(e){return o.bind(function(n){return qe.eq(e,n)?Jn(t.table(),t.first(),t.last()):h.none()})})})},rr="data-mce-selected",or={selected:r(rr),selectedSelector:r("td[data-mce-selected],th[data-mce-selected]"),attributeSelector:r("[data-mce-selected]"),firstSelected:r("data-mce-first-selected"),firstSelectedSelector:r("td[data-mce-first-selected],th[data-mce-first-selected]"),lastSelected:r("data-mce-last-selected"),lastSelectedSelector:r("td[data-mce-last-selected],th[data-mce-last-selected]")},ir=function(e){if(!b(e))throw new Error("cases must be an array");if(0===e.length)throw new Error("there must be at least one case");var t=[],n={};return N(e,function(r,o){var i=j(r);if(1!==i.length)throw new Error("one and only one name per case");var u=i[0],a=r[u];if(void 0!==n[u])throw new Error("duplicate key detected:"+u);if("cata"===u)throw new Error("cannot have a case named cata (sorry)");if(!b(a))throw new Error("case arguments must be an array");t.push(u),n[u]=function(){var n=arguments.length;if(n!==a.length)throw new Error("Wrong number of arguments to case "+u+". Expected "+a.length+" ("+a+"), got "+n);for(var r=new Array(n),i=0;i<r.length;i++)r[i]=arguments[i];return{fold:function(){if(arguments.length!==e.length)throw new Error("Wrong number of arguments to fold. Expected "+e.length+", got "+arguments.length);return arguments[o].apply(null,r)},match:function(e){var n=j(e);if(t.length!==n.length)throw new Error("Wrong number of arguments to match. Expected: "+t.join(",")+"\nActual: "+n.join(","));if(!M(t,function(e){return S(n,e)}))throw new Error("Not all branches were specified when using match. Specified: "+n.join(", ")+"\nRequired: "+t.join(", "));return e[u].apply(null,r)},log:function(e){console.log(e,{constructors:t,constructor:u,params:r})}}}}),n},ur=ir([{none:[]},{multiple:["elements"]},{single:["selection"]}]),ar={cata:function(e,t,n,r){return e.fold(t,n,r)},none:ur.none,multiple:ur.multiple,single:ur.single},cr=function(e,t){return ar.cata(t.get(),r([]),o,r([e]))},lr=function(e,t){return ar.cata(t.get(),h.none,function(t,n){return 0===t.length?h.none():nr(e,or.firstSelectedSelector(),or.lastSelectedSelector()).bind(function(e){return t.length>1?h.some({bounds:r(e),cells:r(t)}):h.none()})},h.none)},fr=function(e,t){var n=cr(e,t);return n.length>0&&M(n,function(e){return at.has(e,"rowspan")&&parseInt(at.get(e,"rowspan"),10)>1||at.has(e,"colspan")&&parseInt(at.get(e,"colspan"),10)>1})?h.some(n):h.none()},sr=cr,dr=function(e){return{element:r(e),mergable:h.none,unmergable:h.none,selection:r([e])}},mr=z("element","clipboard","generators"),gr={noMenu:dr,forMenu:function(e,t,n){return{element:r(n),mergable:r(lr(t,e)),unmergable:r(fr(n,e)),selection:r(sr(n,e))}},notCell:function(e){return dr(e)},paste:mr,pasteRows:function(e,t,n,o,i){return{element:r(n),mergable:h.none,unmergable:h.none,selection:r(sr(n,e)),clipboard:r(o),generators:r(i)}}},hr={registerEvents:function(e,n,r,o){e.on("BeforeGetContent",function(r){!0===r.selection&&ar.cata(n.get(),t,function(t){r.preventDefault(),function(e){return Rt.table(e[0]).map($t).map(function(e){return[Gt(e,or.attributeSelector())]})}(t).each(function(t){r.content=T(t,function(t){return function(e,t){return e.selection.serializer.serialize(t.dom(),{})}(e,t)}).join("")})},t)}),e.on("BeforeSetContent",function(t){!0===t.selection&&!0===t.paste&&h.from(e.dom.getParent(e.selection.getStart(),"th,td")).each(function(n){var i=oe.fromDom(n);Rt.table(i).bind(function(n){var u=E(gn(t.content),function(e){return"meta"!==nt.name(e)});if(1===u.length&&"table"===nt.name(u[0])){t.preventDefault();var a=oe.fromDom(e.getDoc()),c=mn(a),l=gr.paste(i,u[0],c);r.pasteCells(n,l).each(function(t){e.selection.setRng(t),e.focus(),o.clear(n)})}})})})}};function pr(e,t){var n=function(n){var r=t(n);if(r<=0||null===r){var o=Mt.get(n,e);return parseFloat(o)||0}return r},r=function(e,t){return O(t,function(t,n){var r=Mt.get(e,n),o=void 0===r?0:parseInt(r,10);return isNaN(o)?t:t+o},0)};return{set:function(t,n){if(!x(n)&&!n.match(/^[0-9]+$/))throw e+".set accepts only positive integer values. Value was "+n;var r=t.dom();At.isSupported(r)&&(r.style[e]=n+"px")},get:n,getOuter:n,aggregate:r,max:function(e,t,n){var o=r(e,n);return t>o?t-o:0}}}var vr=pr("height",function(e){var t=e.dom();return ft.inBody(e)?t.getBoundingClientRect().height:t.offsetHeight}),br=function(e){return vr.get(e)},wr=function(e){return vr.getOuter(e)},yr=pr("width",function(e){return e.dom().offsetWidth}),xr=function(e){return yr.get(e)},Cr=function(e){return yr.getOuter(e)},Sr=_e.detect(),Rr=function(e,t,n){return function(e,t){var n=parseFloat(e);return isNaN(n)?t:n}(Mt.get(e,t),n)},Tr=function(e){return Sr.browser.isIE()||Sr.browser.isEdge()?function(e){var t=Rr(e,"padding-top",0),n=Rr(e,"padding-bottom",0),r=Rr(e,"border-top-width",0),o=Rr(e,"border-bottom-width",0),i=e.dom().getBoundingClientRect().height;return"border-box"===Mt.get(e,"box-sizing")?i:i-t-n-(r+o)}(e):Rr(e,"height",br(e))},Nr=/(\d+(\.\d+)?)(\w|%)*/,Er=/(\d+(\.\d+)?)%/,Dr=/(\d+(\.\d+)?)px|em/,Or=function(e,t){Mt.set(e,"height",t+"px")},Ar=function(e,t,n,r){var o=parseInt(e,10);return function(e,t){return function(e,t,n){return""===t||!(e.length<t.length)&&e.substr(n,n+t.length)===t}(e,t,e.length-t.length)}(e,"%")&&"table"!==nt.name(t)?function(e,t,n,r){var o=Rt.table(e).map(function(e){var r=n(e);return Math.floor(t/100*r)}).getOr(t);return r(e,o),o}(t,o,n,r):o},kr=function(e){var t=function(e){return Mt.getRaw(e,"height").getOrThunk(function(){return Tr(e)+"px"})}(e);return t?Ar(t,e,br,Or):br(e)},Pr=function(e,t){return at.has(e,t)?parseInt(at.get(e,t),10):1},Ir=function(e){return Mt.getRaw(e,"width").fold(function(){return h.from(at.get(e,"width"))},function(e){return h.some(e)})},Br=function(e,t){return e/t.pixelWidth()*100},Wr={percentageBasedSizeRegex:r(Er),pixelBasedSizeRegex:r(Dr),setPixelWidth:function(e,t){Mt.set(e,"width",t+"px")},setPercentageWidth:function(e,t){Mt.set(e,"width",t+"%")},setHeight:Or,getPixelWidth:function(e,t){return Ir(e).fold(function(){return xr(e)},function(n){return function(e,t,n){if(Dr.test(t)){var r=Dr.exec(t);return parseInt(r[1],10)}if(Er.test(t)){var o=Er.exec(t);return function(e,t){return e/100*t.pixelWidth()}(parseFloat(o[1]),n)}return xr(e)}(e,n,t)})},getPercentageWidth:function(e,t){return Ir(e).fold(function(){var n=xr(e);return Br(n,t)},function(n){return function(e,t,n){if(Er.test(t)){var r=Er.exec(t);return parseFloat(r[1])}var o=xr(e);return Br(o,n)}(e,n,t)})},getGenericWidth:function(e){return Ir(e).bind(function(e){if(Nr.test(e)){var t=Nr.exec(e);return h.some({width:r(t[1]),unit:r(t[3])})}return h.none()})},setGenericWidth:function(e,t,n){Mt.set(e,"width",t+n)},getHeight:function(e){return function(e,t,n){return n(e)/Pr(e,t)}(e,"rowspan",kr)},getRawWidth:Ir},Mr=function(e,t){Wr.getGenericWidth(e).each(function(n){var r=n.width()/2;Wr.setGenericWidth(e,r,n.unit()),Wr.setGenericWidth(t,r,n.unit())})},_r=function(e,t){var n=t||oe.fromDom(document.documentElement);return bt.ancestor(e,i(qe.eq,n)).isSome()},Lr=function(e){var t=e.dom();return t===t.window&&e instanceof Window?e:nt.isDocument(e)?t.defaultView||t.parentWindow:null},jr=function(e,t){return{left:r(e),top:r(t),translate:function(n,r){return jr(e+n,t+r)}}},qr=jr,Fr=function(e,t){return void 0!==e?e:void 0!==t?t:0},Hr=function(e){var t=e.dom(),n=t.ownerDocument,r=n.body,o=oe.fromDom(n.documentElement);return r===t?qr(r.offsetLeft,r.offsetTop):_r(e,o)?function(e){var t=e.getBoundingClientRect();return qr(t.left,t.top)}(t):qr(0,0)},zr=function(e){var t=e.dom().ownerDocument,n=t.body,r=Lr(oe.fromDom(t)),o=t.documentElement,i=Fr(r.pageYOffset,o.scrollTop),u=Fr(r.pageXOffset,o.scrollLeft),a=Fr(o.clientTop,n.clientTop),c=Fr(o.clientLeft,n.clientLeft);return Hr(e).translate(u-c,i-a)},Ur=z("row","y"),Vr=z("col","x"),Gr=function(e){return zr(e).left()+Cr(e)},Yr=function(e){return zr(e).left()},Xr=function(e,t){return Vr(e,Yr(t))},Kr=function(e,t){return Vr(e,Gr(t))},Jr=function(e){return zr(e).top()},$r=function(e,t,n){if(0===n.length)return[];var r=T(n.slice(1),function(t,n){return t.map(function(t){return e(n,t)})}),o=n[n.length-1].map(function(e){return t(n.length-1,e)});return r.concat([o])},Qr={delta:o,positions:i($r,function(e,t){return Ur(e,Jr(t))},function(e,t){return Ur(e,Jr(t)+wr(t))}),edge:Jr},Zr={delta:o,edge:Yr,positions:i($r,Xr,Kr)},eo={height:Qr,rtl:{delta:function(e,t){return-e},edge:Gr,positions:i($r,Kr,Xr)},ltr:Zr},to={ltr:eo.ltr,rtl:eo.rtl};function no(e){var t=function(t){return e(t).isRtl()?to.rtl:to.ltr};return{delta:function(e,n){return t(n).delta(e,n)},edge:function(e){return t(e).edge(e)},positions:function(e,n){return t(n).positions(e,n)}}}var ro=function(e){var t=Tt(e);return Ot.generate(t).grid()},oo=function(e){var t=e,n=function(){return t};return{get:n,set:function(e){t=e},clone:function(){return oo(n())}}},io=function(e,t,n){if(0===t.length)throw new Error("You must specify at least one required field.");return Y("required",t),X(t),function(r){var o=j(r);M(t,function(e){return S(o,e)})||V(t,o),e(t,o);var i=E(t,function(e){return!n.validate(r[e],e)});return i.length>0&&function(e,t){throw new Error("All values need to be of type: "+t+". Keys ("+U(e).join(", ")+") were not.")}(i,n.label),r}},uo=function(e,t){var n=E(t,function(t){return!S(e,t)});n.length>0&&G(n)},ao=function(e){return function(e,t){return io(e,t,{validate:y,label:"function"})}(uo,e)},co=function(e){var t=at.has(e,"colspan")?parseInt(at.get(e,"colspan"),10):1,n=at.has(e,"rowspan")?parseInt(at.get(e,"rowspan"),10):1;return{element:r(e),colspan:r(t),rowspan:r(n)}},lo=ao(["cell","row","replace","gap"]),fo=function(e,t){lo(e);var n=oo(h.none()),r=void 0!==t?t:co,o=function(t){return function(t){return e.cell(t)}(r(t))},i=function(e){var t=o(e);return n.get().isNone()&&n.set(h.some(t)),u=h.some({item:e,replacement:t}),t},u=h.none();return{getOrInit:function(e,t){return u.fold(function(){return i(e)},function(n){return t(e,n.item)?n.replacement:i(e)})},cursor:n.get}},so=function(e,t){return function(n){var r=oo(h.none());lo(n);var o=[],i=function(i){var u=n.replace(i,t,{scope:e});return o.push({item:i,sub:u}),r.get().isNone()&&r.set(h.some(u)),u};return{replaceOrInit:function(e,t){return function(e,t){return A(o,function(n){return t(n.item,e)})}(e,t).fold(function(){return i(e)},function(n){return t(e,n.item)?n.sub:i(e)})},cursor:r.get}}},mo=function(e){lo(e);var t=oo(h.none());return{combine:function(n){return t.get().isNone()&&t.set(h.some(n)),function(){var t=e.cell({element:r(n),colspan:r(1),rowspan:r(1)});return Mt.remove(t,"width"),Mt.remove(n,"width"),t}},cursor:t.get}},go=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","table","thead","tfoot","tbody","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"],ho=function(e,t){var n=e.property().name(t);return S(go,n)},po=function(e,t){return S(["br","img","hr","input"],e.property().name(t))},vo=ho,bo=function(e,t){var n=e.property().name(t);return S(["ol","ul"],n)},wo=po,yo=pn(),xo=function(e){return vo(yo,e)},Co=function(e){return bo(yo,e)},So=function(e){return wo(yo,e)},Ro=function(e){var t=function(e){return"br"===nt.name(e)},n=function(e){return an.last(e).bind(function(n){var r=function(e){return Ye.nextSibling(e).map(function(e){return!!xo(e)||(So(e)?"img"!==nt.name(e):void 0)}).getOr(!1)}(n);return Ye.parent(n).map(function(o){return!0===r||function(e){return"li"===nt.name(e)||bt.ancestor(e,Co).isSome()}(o)||t(n)||xo(o)&&!qe.eq(e,o)?[]:[oe.fromTag("br")]})}).getOr([])},r=function(){var r=W(e,function(e){var r=Ye.children(e);return function(e){return M(e,function(e){return t(e)||nt.isText(e)&&0===en.get(e).trim().length})}(r)?[]:r.concat(n(e))});return 0===r.length?[oe.fromTag("br")]:r}();Ht.empty(e[0]),qt.append(e[0],r)},To=Object.prototype.hasOwnProperty,No=function(e){return function(){for(var t=new Array(arguments.length),n=0;n<t.length;n++)t[n]=arguments[n];if(0===t.length)throw new Error("Can't merge zero objects");for(var r={},o=0;o<t.length;o++){var i=t[o];for(var u in i)To.call(i,u)&&(r[u]=e(r[u],i[u]))}return r}}(function(e,t){return t}),Eo=function(e){for(var t=[],n=function(e){t.push(e)},r=0;r<e.length;r++)e[r].each(n);return t},Do=function(e,t){for(var n=0;n<e.length;n++){var r=t(e[n],n);if(r.isSome())return r}return h.none()},Oo=function(e,t){return ne.rowcells(t,e.section())},Ao=function(e,t){return e.cells()[t]},ko={addCell:function(e,t,n){var r=e.cells(),o=r.slice(0,t),i=r.slice(t),u=o.concat([n]).concat(i);return Oo(e,u)},setCells:Oo,mutateCell:function(e,t,n){e.cells()[t]=n},getCell:Ao,getCellElement:function(e,t){return Ao(e,t).element()},mapCells:function(e,t){var n=e.cells(),r=T(n,t);return ne.rowcells(r,e.section())},cellLength:function(e){return e.cells().length}},Po=function(e,t){if(0===e.length)return 0;var n=e[0];return k(e,function(e){return!t(n.element(),e.element())}).fold(function(){return e.length},function(e){return e})},Io=function(e,t,n,o){var i=function(e,t){return e[t]}(e,t).cells().slice(n),u=Po(i,o),a=function(e,t){return T(e,function(e){return ko.getCell(e,t)})}(e,n).slice(t),c=Po(a,o);return{colspan:r(u),rowspan:r(c)}},Bo=function(e,t){var n=T(e,function(e,t){return T(e.cells(),function(e,t){return!1})});return T(e,function(r,o){var i=W(r.cells(),function(r,i){if(!1===n[o][i]){var u=Io(e,o,i,t);return function(e,t,r,o){for(var i=e;i<e+r;i++)for(var u=t;u<t+o;u++)n[i][u]=!0}(o,i,u.rowspan(),u.colspan()),[ne.detailnew(r.element(),u.rowspan(),u.colspan(),r.isNew())]}return[]});return ne.rowdetails(i,r.section())})},Wo=function(e,t,n){for(var r=[],o=0;o<e.grid().rows();o++){for(var i=[],u=0;u<e.grid().columns();u++){var a=Ot.getAt(e,o,u).map(function(e){return ne.elementnew(e.element(),n)}).getOrThunk(function(){return ne.elementnew(t.gap(),!0)});i.push(a)}var c=ne.rowcells(i,e.all()[o].section());r.push(c)}return r},Mo=function(e,t,n,r){n===r?at.remove(e,t):at.set(e,t,n)},_o=function(e,t){var n=[],o=[],i=function(t,r){t.length>0?function(t,r){var i=yt.child(e,r).getOrThunk(function(){var t=oe.fromTag(r,Ye.owner(e).dom());return jt.append(e,t),t});Ht.empty(i);var u=T(t,function(e){e.isNew()&&n.push(e.element());var t=e.element();return Ht.empty(t),N(e.cells(),function(e){e.isNew()&&o.push(e.element()),Mo(e.element(),"colspan",e.colspan(),1),Mo(e.element(),"rowspan",e.rowspan(),1),jt.append(t,e.element())}),t});qt.append(i,u)}(t,r):function(t){yt.child(e,t).each(Ht.remove)}(r)},u=[],a=[],c=[];return N(t,function(e){switch(e.section()){case"thead":u.push(e);break;case"tbody":a.push(e);break;case"tfoot":c.push(e)}}),i(u,"thead"),i(a,"tbody"),i(c,"tfoot"),{newRows:r(n),newCells:r(o)}},Lo=function(e){return T(e,function(e){var t=Jt(e.element());return N(e.cells(),function(e){var n=$t(e.element());Mo(n,"colspan",e.colspan(),1),Mo(n,"rowspan",e.rowspan(),1),jt.append(t,n)}),t})},jo=function(e,t){for(var n=[],r=0;r<e;r++)n.push(t(r));return n},qo=function(e,t){for(var n=[],r=e;r<t;r++)n.push(r);return n},Fo=function(e,t){if(t<0||t>=e.length-1)return h.none();var n=e[t].fold(function(){var n=L(e.slice(0,t));return Do(n,function(e,t){return e.map(function(e){return{value:e,delta:t+1}})})},function(e){return h.some({value:e,delta:0})}),r=e[t+1].fold(function(){var n=e.slice(t+1);return Do(n,function(e,t){return e.map(function(e){return{value:e,delta:t+1}})})},function(e){return h.some({value:e,delta:1})});return n.bind(function(e){return r.map(function(t){var n=t.delta+e.delta;return Math.abs(t.value-e.value)/n})})},Ho=function(e,t,n){var r=e();return A(r,t).orThunk(function(){return h.from(r[0]).orThunk(n)}).map(function(e){return e.element()})},zo=function(e){var t=e.grid(),n=qo(0,t.columns()),o=qo(0,t.rows());return T(n,function(t){return Ho(function(){return W(o,function(n){return Ot.getAt(e,n,t).filter(function(e){return e.column()===t}).fold(r([]),function(e){return[e]})})},function(e){return 1===e.colspan()},function(){return Ot.getAt(e,0,t)})})},Uo=function(e){var t=e.grid(),n=qo(0,t.rows()),o=qo(0,t.columns());return T(n,function(t){return Ho(function(){return W(o,function(n){return Ot.getAt(e,t,n).filter(function(e){return e.row()===t}).fold(r([]),function(e){return[e]})})},function(e){return 1===e.rowspan()},function(){return Ot.getAt(e,t,0)})})},Vo=function(e,t,n,r,o){var i=oe.fromTag("div");return Mt.setAll(i,{position:"absolute",left:t-r/2+"px",top:n+"px",height:o+"px",width:r+"px"}),at.setAll(i,{"data-column":e,role:"presentation"}),i},Go=function(e,t,n,r,o){var i=oe.fromTag("div");return Mt.setAll(i,{position:"absolute",left:t+"px",top:n-o/2+"px",height:o+"px",width:r+"px"}),at.setAll(i,{"data-row":e,role:"presentation"}),i},Yo=function(e){var t=e.replace(/\./g,"-");return{resolve:function(e){return t+"-"+e}}},Xo={resolve:Yo("ephox-snooker").resolve},Ko=function(e,t){var n=at.get(e,t);return void 0===n||""===n?[]:n.split(" ")},Jo=Ko,$o=function(e,t,n){var r=Ko(e,t).concat([n]);return at.set(e,t,r.join(" ")),!0},Qo=function(e,t,n){var r=E(Ko(e,t),function(e){return e!==n});return r.length>0?at.set(e,t,r.join(" ")):at.remove(e,t),!1},Zo=function(e){return Jo(e,"class")},ei=function(e,t){return $o(e,"class",t)},ti=function(e,t){return Qo(e,"class",t)},ni=Zo,ri=ei,oi=ti,ii=function(e,t){return S(Zo(e),t)?ti(e,t):ei(e,t)},ui=function(e){return void 0!==e.dom().classList},ai=function(e,t){return ui(e)&&e.dom().classList.contains(t)},ci={add:function(e,t){ui(e)?e.dom().classList.add(t):ri(e,t)},remove:function(e,t){ui(e)?e.dom().classList.remove(t):oi(e,t),function(e){0===(ui(e)?e.dom().classList:ni(e)).length&&at.remove(e,"class")}(e)},toggle:function(e,t){return ui(e)?e.dom().classList.toggle(t):ii(e,t)},toggler:function(e,t){var n=ui(e),r=e.dom().classList;return function(e,t,n){var r=n||!1,o=function(){t(),r=!0},i=function(){e(),r=!1};return{on:o,off:i,toggle:function(){(r?i:o)()},isOn:function(){return r}}}(function(){n?r.remove(t):oi(e,t)},function(){n?r.add(t):ri(e,t)},ai(e,t))},has:ai},li=Xo.resolve("resizer-bar"),fi=Xo.resolve("resizer-rows"),si=Xo.resolve("resizer-cols"),di=function(e){var t=mt.descendants(e.parent(),"."+li);N(t,Ht.remove)},mi=function(e,t,n){var r=e.origin();N(t,function(t,o){t.each(function(t){var o=n(r,t);ci.add(o,li),jt.append(e.parent(),o)})})},gi=function(e,t,n,r,o,i){var u=zr(t);!function(e,t,n,r){mi(e,t,function(e,t){var o=Go(t.row(),n.left()-e.left(),t.y()-e.top(),r,7);return ci.add(o,fi),o})}(e,n.length>0?o.positions(n,t):[],u,Cr(t)),function(e,t,n,r){mi(e,t,function(e,t){var o=Vo(t.col(),t.x()-e.left(),n.top()-e.top(),7,r);return ci.add(o,si),o})}(e,r.length>0?i.positions(r,t):[],u,wr(t))},hi=function(e,t){var n=mt.descendants(e.parent(),"."+li);N(n,t)},pi={refresh:function(e,t,n,r){di(e);var o=Tt(t),i=Ot.generate(o),u=Uo(i),a=zo(i);gi(e,t,u,a,n,r)},hide:function(e){hi(e,function(e){Mt.set(e,"display","none")})},show:function(e){hi(e,function(e){Mt.set(e,"display","block")})},destroy:di,isRowBar:function(e){return ci.has(e,fi)},isColBar:function(e){return ci.has(e,si)}},vi=function(e,t){return T(e,function(e){var n=function(e){return Do(e,function(e){return Ye.parent(e.element()).map(function(e){var t=Ye.parent(e).isNone();return ne.elementnew(e,t)})}).getOrThunk(function(){return ne.elementnew(t.row(),!0)})}(e.details());return ne.rowdatanew(n.element(),e.details(),e.section(),n.isNew())})},bi=function(e,t){var n=Bo(e,qe.eq);return vi(n,t)},wi=function(e,t){var n=B(T(e.all(),function(e){return e.cells()}));return A(n,function(e){return qe.eq(t,e.element())})},yi=function(e,t,n,o,i){return function(u,a,c,l,f){var s=Tt(a),d=Ot.generate(s);return t(d,c).map(function(t){var n=function(e,t){return Wo(e,t,!1)}(d,l),o=e(n,t,qe.eq,i(l)),u=bi(o.grid(),l);return{grid:r(u),cursor:o.cursor}}).fold(function(){return h.none()},function(e){var t=_o(a,e.grid());return n(a,e.grid(),f),o(a),pi.refresh(u,a,eo.height,f),h.some({cursor:e.cursor,newRows:t.newRows,newCells:t.newCells})})}},xi=bi,Ci=function(e,t){return Rt.cell(t.element()).bind(function(t){return wi(e,t)})},Si=function(e,t){var n=T(t.selection(),function(t){return Rt.cell(t).bind(function(t){return wi(e,t)})}),r=Eo(n);return r.length>0?h.some(r):h.none()},Ri=function(e,t){return Rt.cell(t.element()).bind(function(n){return wi(e,n).map(function(e){return No(e,{generators:t.generators,clipboard:t.clipboard})})})},Ti=function(e,t){var n=T(t.selection(),function(t){return Rt.cell(t).bind(function(t){return wi(e,t)})}),r=Eo(n);return r.length>0?h.some(No({cells:r},{generators:t.generators,clipboard:t.clipboard})):h.none()},Ni=function(e,t){return t.mergable()},Ei=function(e,t){return t.unmergable()},Di=function(e){return{is:function(t){return e===t},isValue:l,isError:c,getOr:r(e),getOrThunk:r(e),getOrDie:r(e),or:function(t){return Di(e)},orThunk:function(t){return Di(e)},fold:function(t,n){return n(e)},map:function(t){return Di(t(e))},each:function(t){t(e)},bind:function(t){return t(e)},exists:function(t){return t(e)},forall:function(t){return t(e)},toOption:function(){return h.some(e)}}},Oi=function(e){return{is:c,isValue:c,isError:l,getOr:o,getOrThunk:function(e){return e()},getOrDie:function(){return function(e){return function(){throw new Error(e)}}(String(e))()},or:function(e){return e},orThunk:function(e){return e()},fold:function(t,n){return t(e)},map:function(t){return Oi(e)},each:t,bind:function(t){return Oi(e)},exists:c,forall:l,toOption:h.none}},Ai={value:Di,error:Oi},ki=function(e,t){return T(e,function(){return ne.elementnew(t.cell(),!0)})},Pi=function(e,t,n){return e.concat(jo(t,function(t){return ko.setCells(e[e.length-1],ki(e[e.length-1].cells(),n))}))},Ii=function(e,t,n){return T(e,function(e){return ko.setCells(e,e.cells().concat(ki(qo(0,t),n)))})},Bi=function(e,t,n){if(e.row()>=t.length||e.column()>ko.cellLength(t[0]))return Ai.error("invalid start address out of table bounds, row: "+e.row()+", column: "+e.column());var o=t.slice(e.row()),i=o[0].cells().slice(e.column()),u=ko.cellLength(n[0]),a=n.length;return Ai.value({rowDelta:r(o.length-a),colDelta:r(i.length-u)})},Wi=function(e,t){var n=ko.cellLength(e[0]),o=ko.cellLength(t[0]);return{rowDelta:r(0),colDelta:r(n-o)}},Mi=function(e,t,n){var r=t.colDelta()<0?Ii:o;return(t.rowDelta()<0?Pi:o)(r(e,Math.abs(t.colDelta()),n),Math.abs(t.rowDelta()),n)},_i=function(e,t,n,r){if(0===e.length)return e;for(var o=t.startRow();o<=t.finishRow();o++)for(var i=t.startCol();i<=t.finishCol();i++)ko.mutateCell(e[o],i,ne.elementnew(r(),!1));return e},Li=function(e,t,n,r){for(var o=!0,i=0;i<e.length;i++)for(var u=0;u<ko.cellLength(e[0]);u++){var a=n(ko.getCellElement(e[i],u),t);!0===a&&!1===o?ko.mutateCell(e[i],u,ne.elementnew(r(),!0)):!0===a&&(o=!1)}return e},ji=function(e,t,n,r){if(t>0&&t<e.length){var o=function(e,t){return O(e,function(e,n){return R(e,function(e){return t(e.element(),n.element())})?e:e.concat([n])},[])}(e[t-1].cells(),n);N(o,function(o){for(var i=h.none(),u=t;u<e.length;u++)for(var a=0;a<ko.cellLength(e[0]);a++){var c=e[u].cells()[a];n(c.element(),o.element())&&(i.isNone()&&(i=h.some(r())),i.each(function(t){ko.mutateCell(e[u],a,ne.elementnew(t,!0))}))}})}return e},qi=function(e,t,n,r){var o=ko.getCell(e[t],n),u=i(r,o.element()),a=e[t];return e.length>1&&ko.cellLength(a)>1&&(n>0&&u(ko.getCellElement(a,n-1))||n<a.length-1&&u(ko.getCellElement(a,n+1))||t>0&&u(ko.getCellElement(e[t-1],n))||t<e.length-1&&u(ko.getCellElement(e[t+1],n)))},Fi=function(e,t,n,r,o){return Bi(e,t,n).map(function(i){var u=Mi(t,i,r);return function(e,t,n,r,o){for(var i=e.row(),u=e.column(),a=i+n.length,c=u+ko.cellLength(n[0]),l=i;l<a;l++)for(var f=u;f<c;f++){qi(t,l,f,o)&&Li(t,ko.getCellElement(t[l],f),o,r.cell);var s=ko.getCellElement(n[l-i],f-u),d=r.replace(s);ko.mutateCell(t[l],f,ne.elementnew(d,!0))}return t}(e,u,n,r,o)})},Hi=function(e,t,n,r,o){ji(t,e,o,r.cell);var i=Wi(n,t),u=Mi(n,i,r),a=Wi(t,u),c=Mi(t,a,r);return c.slice(0,e).concat(u).concat(c.slice(e,c.length))},zi=function(e,t,n,r,o){var i=e.slice(0,t),u=e.slice(t),a=ko.mapCells(e[n],function(n,i){return t>0&&t<e.length&&r(ko.getCellElement(e[t-1],i),ko.getCellElement(e[t],i))?ko.getCell(e[t],i):ne.elementnew(o(n.element(),r),!0)});return i.concat([a]).concat(u)},Ui=function(e,t,n,r,o){return T(e,function(e){var i=t>0&&t<ko.cellLength(e)&&r(ko.getCellElement(e,t-1),ko.getCellElement(e,t))?ko.getCell(e,t):ne.elementnew(o(ko.getCellElement(e,n),r),!0);return ko.addCell(e,t,i)})},Vi=function(e,t,n,r,o){var i=n+1;return T(e,function(e,u){var a=u===t?ne.elementnew(o(ko.getCellElement(e,n),r),!0):ko.getCell(e,n);return ko.addCell(e,i,a)})},Gi=function(e,t,n,r,o){var i=t+1,u=e.slice(0,i),a=e.slice(i),c=ko.mapCells(e[t],function(e,t){return t===n?ne.elementnew(o(e.element(),r),!0):e});return u.concat([c]).concat(a)},Yi=function(e,t,n){return e.slice(0,t).concat(e.slice(n+1))},Xi=function(e,t,n){var r=T(e,function(e){var r=e.cells().slice(0,t).concat(e.cells().slice(n+1));return ne.rowcells(r,e.section())});return E(r,function(e){return e.cells().length>0})},Ki=function(e,t,n,r){return T(e,function(e){return ko.mapCells(e,function(e){return function(e){return R(t,function(t){return n(e.element(),t.element())})}(e)?ne.elementnew(r(e.element(),n),!0):e})})},Ji=function(e,t,n,r){return void 0!==ko.getCellElement(e[t],n)&&t>0&&r(ko.getCellElement(e[t-1],n),ko.getCellElement(e[t],n))},$i=function(e,t,n){return t>0&&n(ko.getCellElement(e,t-1),ko.getCellElement(e,t))},Qi=function(e,t,n,r){var o=W(e,function(r,o){return Ji(e,o,t,n)||$i(r,t,n)?[]:[ko.getCell(r,t)]});return Ki(e,o,n,r)},Zi=function(e,t,n,r){var o=e[t],i=W(o.cells(),function(r,i){return Ji(e,t,i,n)||$i(o,i,n)?[]:[r]});return Ki(e,i,n,r)},eu=function(e){return{fold:e}},tu=function(){return eu(function(e,t,n,r,o){return e()})},nu=function(e){return eu(function(t,n,r,o,i){return n(e)})},ru=function(e,t){return eu(function(n,r,o,i,u){return o(e,t)})},ou=function(e,t,n){return eu(function(r,o,i,u,a){return u(e,t,n)})},iu=function(e,t){return eu(function(n,r,o,i,u){return u(e,t)})},uu=function(e,t,n,o){var i=e.slice(0),u=function(e,t){return 0===e.length?tu():1===e.length?nu(0):0===t?ru(0,1):t===e.length-1?iu(t-1,t):t>0&&t<e.length-1?ou(t-1,t,t+1):tu()}(e,t),a=function(e){return T(e,r(0))},c=r(a(i)),l=function(e,t){if(n>=0){var r=Math.max(o.minCellWidth(),i[t]-n);return a(i.slice(0,e)).concat([n,r-i[t]]).concat(a(i.slice(t+1)))}var u=Math.max(o.minCellWidth(),i[e]+n),c=i[e]-u;return a(i.slice(0,e)).concat([u-i[e],c]).concat(a(i.slice(t+1)))},f=l;return u.fold(c,function(e){return o.singleColumnWidth(i[e],n)},f,function(e,t,n){return l(t,n)},function(e,t){if(n>=0)return a(i.slice(0,t)).concat([n]);var r=Math.max(o.minCellWidth(),i[t]+n);return a(i.slice(0,t)).concat([r-i[t]])})},au=function(e,t){return at.has(e,t)&&parseInt(at.get(e,t),10)>1},cu={hasColspan:function(e){return au(e,"colspan")},hasRowspan:function(e){return au(e,"rowspan")},minWidth:r(10),minHeight:r(10),getInt:function(e,t){return parseInt(Mt.get(e,t),10)}},lu=function(e,t,n){return Mt.getRaw(e,t).fold(function(){return n(e)+"px"},function(e){return e})},fu=function(e){return lu(e,"width",Wr.getPixelWidth)},su=function(e){return lu(e,"height",Wr.getHeight)},du=function(e,t,n,r,o){var i=zo(e),a=T(i,function(e){return e.map(t.edge)});return T(i,function(e,t){return e.filter(u(cu.hasColspan)).fold(function(){var e=Fo(a,t);return r(e)},function(e){return n(e,o)})})},mu=function(e){return e.map(function(e){return e+"px"}).getOr("")},gu=function(e,t,n,r){var o=Uo(e),i=T(o,function(e){return e.map(t.edge)});return T(o,function(e,t){return e.filter(u(cu.hasRowspan)).fold(function(){var e=Fo(i,t);return r(e)},function(e){return n(e)})})},hu={getRawWidths:function(e,t){return du(e,t,fu,mu)},getPixelWidths:function(e,t,n){return du(e,t,Wr.getPixelWidth,function(e){return e.getOrThunk(n.minCellWidth)},n)},getPercentageWidths:function(e,t,n){return du(e,t,Wr.getPercentageWidth,function(e){return e.fold(function(){return n.minCellWidth()},function(e){return e/n.pixelWidth()*100})},n)},getPixelHeights:function(e,t){return gu(e,t,Wr.getHeight,function(e){return e.getOrThunk(cu.minHeight)})},getRawHeights:function(e,t){return gu(e,t,su,mu)}},pu=function(e,t,n){for(var r=0,o=e;o<t;o++)r+=void 0!==n[o]?n[o]:0;return r},vu=function(e,t){var n=Ot.justCells(e);return T(n,function(e){var n=pu(e.column(),e.column()+e.colspan(),t);return{element:e.element,width:r(n),colspan:e.colspan}})},bu=function(e,t){var n=Ot.justCells(e);return T(n,function(e){var n=pu(e.row(),e.row()+e.rowspan(),t);return{element:e.element,height:r(n),rowspan:e.rowspan}})},wu=function(e,t){return T(e.all(),function(e,n){return{element:e.element,height:r(t[n])}})},yu=function(e){var t=parseInt(e,10),n=o;return{width:r(t),pixelWidth:r(t),getWidths:hu.getPixelWidths,getCellDelta:n,singleColumnWidth:function(e,t){return[Math.max(cu.minWidth(),e+t)-e]},minCellWidth:cu.minWidth,setElementWidth:Wr.setPixelWidth,setTableWidth:function(e,t,n){var r=D(t,function(e,t){return e+t},0);Wr.setPixelWidth(e,r)}}},xu=function(e,t){if(Wr.percentageBasedSizeRegex().test(t))return function(e,t){var n=parseFloat(e),o=xr(t);return{width:r(n),pixelWidth:r(o),getWidths:hu.getPercentageWidths,getCellDelta:function(e){return e/o*100},singleColumnWidth:function(e,t){return[100-e]},minCellWidth:function(){return cu.minWidth()/o*100},setElementWidth:Wr.setPercentageWidth,setTableWidth:function(e,t,r){var o=n+r;Wr.setPercentageWidth(e,o)}}}(Wr.percentageBasedSizeRegex().exec(t)[1],e);if(Wr.pixelBasedSizeRegex().test(t)){var n=Wr.pixelBasedSizeRegex().exec(t);return yu(n[1])}var o=xr(e);return yu(o)},Cu=function(e){return Wr.getRawWidth(e).fold(function(){var t=xr(e);return yu(t)},function(t){return xu(e,t)})},Su=function(e){return Ot.generate(e)},Ru=function(e){var t=Tt(e);return Su(t)},Tu={adjustWidth:function(e,t,n,r){var o=Cu(e),i=o.getCellDelta(t),u=Ru(e),a=o.getWidths(u,r,o),c=uu(a,n,i,o),l=T(c,function(e,t){return e+a[t]}),f=vu(u,l);N(f,function(e){o.setElementWidth(e.element(),e.width())}),n===u.grid().columns()-1&&o.setTableWidth(e,l,i)},adjustHeight:function(e,t,n,r){var o=Ru(e),i=hu.getPixelHeights(o,r),u=T(i,function(e,r){return n===r?Math.max(t+e,cu.minHeight()):e}),a=bu(o,u),c=wu(o,u);N(c,function(e){Wr.setHeight(e.element(),e.height())}),N(a,function(e){Wr.setHeight(e.element(),e.height())});var l=function(e){return D(e,function(e,t){return e+t},0)}(u);Wr.setHeight(e,l)},adjustWidthTo:function(e,t,n){var r=Cu(e),o=Su(t),i=r.getWidths(o,n,r),u=vu(o,i);N(u,function(e){r.setElementWidth(e.element(),e.width())});var a=D(i,function(e,t){return t+e},0);u.length>0&&r.setElementWidth(e,a)}},Nu=function(e){0===Rt.cells(e).length&&Ht.remove(e)},Eu=z("grid","cursor"),Du=function(e,t,n){return Ou(e,t,n).orThunk(function(){return Ou(e,0,0)})},Ou=function(e,t,n){return h.from(e[t]).bind(function(e){return h.from(e.cells()[n]).bind(function(e){return h.from(e.element())})})},Au=function(e,t,n){return Eu(e,Ou(e,t,n))},ku=function(e){return O(e,function(e,t){return R(e,function(e){return e.row()===t.row()})?e:e.concat([t])},[]).sort(function(e,t){return e.row()-t.row()})},Pu=function(e){return O(e,function(e,t){return R(e,function(e){return e.column()===t.column()})?e:e.concat([t])},[]).sort(function(e,t){return e.column()-t.column()})},Iu=function(e,t,n){var r=Nt(e,n),o=Ot.generate(r);return Wo(o,t,!0)},Bu=Tu.adjustWidthTo,Wu={insertRowBefore:yi(function(e,t,n,r){var o=t.row(),i=t.row(),u=zi(e,i,o,n,r.getOrInit);return Au(u,i,t.column())},Ci,t,t,fo),insertRowsBefore:yi(function(e,t,n,r){var o=t[0].row(),i=t[0].row(),u=ku(t),a=O(u,function(e,t){return zi(e,i,o,n,r.getOrInit)},e);return Au(a,i,t[0].column())},Si,t,t,fo),insertRowAfter:yi(function(e,t,n,r){var o=t.row(),i=t.row()+t.rowspan(),u=zi(e,i,o,n,r.getOrInit);return Au(u,i,t.column())},Ci,t,t,fo),insertRowsAfter:yi(function(e,t,n,r){var o=ku(t),i=o[o.length-1].row(),u=o[o.length-1].row()+o[o.length-1].rowspan(),a=O(o,function(e,t){return zi(e,u,i,n,r.getOrInit)},e);return Au(a,u,t[0].column())},Si,t,t,fo),insertColumnBefore:yi(function(e,t,n,r){var o=t.column(),i=t.column(),u=Ui(e,i,o,n,r.getOrInit);return Au(u,t.row(),i)},Ci,Bu,t,fo),insertColumnsBefore:yi(function(e,t,n,r){var o=Pu(t),i=o[0].column(),u=o[0].column(),a=O(o,function(e,t){return Ui(e,u,i,n,r.getOrInit)},e);return Au(a,t[0].row(),u)},Si,Bu,t,fo),insertColumnAfter:yi(function(e,t,n,r){var o=t.column(),i=t.column()+t.colspan(),u=Ui(e,i,o,n,r.getOrInit);return Au(u,t.row(),i)},Ci,Bu,t,fo),insertColumnsAfter:yi(function(e,t,n,r){var o=t[t.length-1].column(),i=t[t.length-1].column()+t[t.length-1].colspan(),u=Pu(t),a=O(u,function(e,t){return Ui(e,i,o,n,r.getOrInit)},e);return Au(a,t[0].row(),i)},Si,Bu,t,fo),splitCellIntoColumns:yi(function(e,t,n,r){var o=Vi(e,t.row(),t.column(),n,r.getOrInit);return Au(o,t.row(),t.column())},Ci,Bu,t,fo),splitCellIntoRows:yi(function(e,t,n,r){var o=Gi(e,t.row(),t.column(),n,r.getOrInit);return Au(o,t.row(),t.column())},Ci,t,t,fo),eraseColumns:yi(function(e,t,n,r){var o=Pu(t),i=Xi(e,o[0].column(),o[o.length-1].column()),u=Du(i,t[0].row(),t[0].column());return Eu(i,u)},Si,Bu,Nu,fo),eraseRows:yi(function(e,t,n,r){var o=ku(t),i=Yi(e,o[0].row(),o[o.length-1].row()),u=Du(i,t[0].row(),t[0].column());return Eu(i,u)},Si,t,Nu,fo),makeColumnHeader:yi(function(e,t,n,r){var o=Qi(e,t.column(),n,r.replaceOrInit);return Au(o,t.row(),t.column())},Ci,t,t,so("row","th")),unmakeColumnHeader:yi(function(e,t,n,r){var o=Qi(e,t.column(),n,r.replaceOrInit);return Au(o,t.row(),t.column())},Ci,t,t,so(null,"td")),makeRowHeader:yi(function(e,t,n,r){var o=Zi(e,t.row(),n,r.replaceOrInit);return Au(o,t.row(),t.column())},Ci,t,t,so("col","th")),unmakeRowHeader:yi(function(e,t,n,r){var o=Zi(e,t.row(),n,r.replaceOrInit);return Au(o,t.row(),t.column())},Ci,t,t,so(null,"td")),mergeCells:yi(function(e,t,n,o){var i=t.cells();Ro(i);var u=_i(e,t.bounds(),n,r(i[0]));return Eu(u,h.from(i[0]))},Ni,t,t,mo),unmergeCells:yi(function(e,t,n,r){var o=D(t,function(e,t){return Li(e,t,n,r.combine(t))},e);return Eu(o,h.from(t[0]))},Ei,Bu,t,mo),pasteCells:yi(function(e,t,n,r){var o=function(e,t){var n=Tt(e),r=Ot.generate(n);return Wo(r,t,!0)}(t.clipboard(),t.generators()),i=ne.address(t.row(),t.column());return Fi(i,e,o,t.generators(),n).fold(function(){return Eu(e,h.some(t.element()))},function(e){var n=Du(e,t.row(),t.column());return Eu(e,n)})},Ri,Bu,t,fo),pasteRowsBefore:yi(function(e,t,n,r){var o=e[t.cells[0].row()],i=t.cells[0].row(),u=Iu(t.clipboard(),t.generators(),o),a=Hi(i,e,u,t.generators(),n),c=Du(a,t.cells[0].row(),t.cells[0].column());return Eu(a,c)},Ti,t,t,fo),pasteRowsAfter:yi(function(e,t,n,r){var o=e[t.cells[0].row()],i=t.cells[t.cells.length-1].row()+t.cells[t.cells.length-1].rowspan(),u=Iu(t.clipboard(),t.generators(),o),a=Hi(i,e,u,t.generators(),n),c=Du(a,t.cells[0].row(),t.cells[0].column());return Eu(a,c)},Ti,t,t,fo)},Mu=function(e){return oe.fromDom(e.getBody())},_u=function(e){return e.getBoundingClientRect().width},Lu=function(e){return e.getBoundingClientRect().height},ju=function(e){return function(t){return qe.eq(t,Mu(e))}},qu=function(e){return/^[0-9]+$/.test(e)&&(e+="px"),e},Fu=function(e){var t=mt.descendants(e,"td[data-mce-style],th[data-mce-style]");at.remove(e,"data-mce-style"),N(t,function(e){at.remove(e,"data-mce-style")})},Hu=function(e){return"rtl"===Mt.get(e,"direction")?"rtl":"ltr"},zu={onDirection:function(e,t){return function(n){return"rtl"===Hu(n)?t:e}},getDirection:Hu},Uu={isRtl:r(!1)},Vu={isRtl:r(!0)},Gu={directionAt:function(e){return"rtl"===zu.getDirection(e)?Vu:Uu}},Yu=["tableprops","tabledelete","|","tableinsertrowbefore","tableinsertrowafter","tabledeleterow","|","tableinsertcolbefore","tableinsertcolafter","tabledeletecol"],Xu={"border-collapse":"collapse",width:"100%"},Ku={border:"1"},Ju=function(e){return e.getParam("table_default_styles",Xu,"object")},$u=function(e){return e.getParam("table_tab_navigation",!0,"boolean")},Qu=function(e){return e.getParam("table_cell_advtab",!0,"boolean")},Zu=function(e){return e.getParam("table_row_advtab",!0,"boolean")},ea=function(e){return e.getParam("table_advtab",!0,"boolean")},ta=function(e){return e.getParam("table_style_by_css",!1,"boolean")},na=function(e){return e.getParam("table_cell_class_list",[],"array")},ra=function(e){return e.getParam("table_row_class_list",[],"array")},oa=function(e){return e.getParam("table_class_list",[],"array")},ia=function(e){return!1===e.getParam("table_responsive_width")},ua=function(e,t){return e.fire("newrow",{node:t})},aa=function(e,t){return e.fire("newcell",{node:t})},ca=function(e,t,n,r){e.fire("ObjectResizeStart",{target:t,width:n,height:r})},la=function(e,t,n,r){e.fire("ObjectResized",{target:t,width:n,height:r})},fa=function(e,n){var r=function(e){return"table"===nt.name(Mu(e))},o=function(e){var t=e.getParam("table_clone_elements");return v(t)?h.some(t.split(/[ ,]/)):Array.isArray(t)?h.some(t):h.none()}(e),i=function(t,n,r,i){return function(u,a){Fu(u);var c=i(),l=oe.fromDom(e.getDoc()),f=no(Gu.directionAt),s=dn(r,l,o);return n(u)?t(c,u,a,s,f).bind(function(t){return N(t.newRows(),function(t){ua(e,t.dom())}),N(t.newCells(),function(t){aa(e,t.dom())}),t.cursor().map(function(t){var n=e.dom.createRng();return n.setStart(t.dom(),0),n.setEnd(t.dom(),0),n})}):h.none()}};return{deleteRow:i(Wu.eraseRows,function(t){var n=ro(t);return!1===r(e)||n.rows()>1},t,n),deleteColumn:i(Wu.eraseColumns,function(t){var n=ro(t);return!1===r(e)||n.columns()>1},t,n),insertRowsBefore:i(Wu.insertRowsBefore,l,t,n),insertRowsAfter:i(Wu.insertRowsAfter,l,t,n),insertColumnsBefore:i(Wu.insertColumnsBefore,l,Mr,n),insertColumnsAfter:i(Wu.insertColumnsAfter,l,Mr,n),mergeCells:i(Wu.mergeCells,l,t,n),unmergeCells:i(Wu.unmergeCells,l,t,n),pasteRowsBefore:i(Wu.pasteRowsBefore,l,t,n),pasteRowsAfter:i(Wu.pasteRowsAfter,l,t,n),pasteCells:i(Wu.pasteCells,l,t,n)}},sa=function(e,t,n){var r=Tt(e),o=Ot.generate(r);return Si(o,t).map(function(e){var t=Wo(o,n,!1).slice(e[0].row(),e[e.length-1].row()+e[e.length-1].rowspan()),r=xi(t,n);return Lo(r)})},da=tinymce.util.Tools.resolve("tinymce.util.Tools"),ma={applyAlign:function(e,t,n){n&&e.formatter.apply("align"+n,{},t)},applyVAlign:function(e,t,n){n&&e.formatter.apply("valign"+n,{},t)},unApplyAlign:function(e,t){da.each("left center right".split(" "),function(n){e.formatter.remove("align"+n,{},t)})},unApplyVAlign:function(e,t){da.each("top middle bottom".split(" "),function(n){e.formatter.remove("valign"+n,{},t)})},getTDTHOverallStyle:function(e,t,n){var r;return r=function(t,r){for(var o=0;o<r.length;o++){var i=e.getStyle(r[o],n);if(void 0===t&&(t=i),t!==i)return""}return t}(r,e.select("td,th",t))}},ga=function(e,t){var n=e.dom,r=t.control.rootControl,o=r.toJSON(),i=n.parseStyle(o.style);i["border-style"]=o.borderStyle,i["border-color"]=o.borderColor,i["background-color"]=o.backgroundColor,i.width=o.width?qu(o.width):"",i.height=o.height?qu(o.height):"",r.find("#style").value(n.serializeStyle(n.parseStyle(n.serializeStyle(i))))},ha=function(e,t){var n=e.dom,r=t.control.rootControl,o=r.toJSON(),i=n.parseStyle(o.style);r.find("#borderStyle").value(i["border-style"]||""),r.find("#borderColor").value(i["border-color"]||""),r.find("#backgroundColor").value(i["background-color"]||""),r.find("#width").value(i.width||""),r.find("#height").value(i.height||"")},pa={createStyleForm:function(e){var t=function(){var t=function(e){return e.getParam("color_picker_callback")}(e);if(t)return function(n){return t.call(e,function(e){n.control.value(e).fire("change")},n.control.value())}};return{title:"Advanced",type:"form",defaults:{onchange:i(ga,e)},items:[{label:"Style",name:"style",type:"textbox",onchange:i(ha,e)},{type:"form",padding:0,formItemDefaults:{layout:"grid",alignH:["start","right"]},defaults:{size:7},items:[{label:"Border style",type:"listbox",name:"borderStyle",width:90,onselect:i(ga,e),values:[{text:"Select...",value:""},{text:"Solid",value:"solid"},{text:"Dotted",value:"dotted"},{text:"Dashed",value:"dashed"},{text:"Double",value:"double"},{text:"Groove",value:"groove"},{text:"Ridge",value:"ridge"},{text:"Inset",value:"inset"},{text:"Outset",value:"outset"},{text:"None",value:"none"},{text:"Hidden",value:"hidden"}]},{label:"Border color",type:"colorbox",name:"borderColor",onaction:t()},{label:"Background color",type:"colorbox",name:"backgroundColor",onaction:t()}]}]}},buildListItems:function(e,t,n){var r=function(e,n){return n=n||[],da.each(e,function(e){var o={text:e.text||e.title};e.menu?o.menu=r(e.menu):(o.value=e.value,t&&t(o)),n.push(o)}),n};return r(e,n||[])},updateStyleField:ga,extractAdvancedStyles:function(e,t){var n=e.parseStyle(e.getAttrib(t,"style")),r={};return n["border-style"]&&(r.borderStyle=n["border-style"]),n["border-color"]&&(r.borderColor=n["border-color"]),n["background-color"]&&(r.backgroundColor=n["background-color"]),r.style=e.serializeStyle(n),r},updateAdvancedFields:ha,syncAdvancedStyleFields:function(e,t){!function(e){return e.control.rootControl.find("#style")[0].getEl().isEqualNode(document.activeElement)}(t)?ga(e,t):ha(e,t)}},va=function(e,t,n){var r,o=e.dom;function i(e,n,r){(1===t.length||r)&&o.setAttrib(e,n,r)}function u(e,n,r){(1===t.length||r)&&o.setStyle(e,n,r)}Qu(e)&&pa.syncAdvancedStyleFields(e,n),r=n.control.rootControl.toJSON(),e.undoManager.transact(function(){da.each(t,function(n){i(n,"scope",r.scope),1===t.length?i(n,"style",r.style):function(e,t){delete e.dataset.mceStyle,e.style.cssText+=";"+t}(n,r.style),i(n,"class",r.class),u(n,"width",qu(r.width)),u(n,"height",qu(r.height)),r.type&&n.nodeName.toLowerCase()!==r.type&&(n=o.rename(n,r.type)),1===t.length&&(ma.unApplyAlign(e,n),ma.unApplyVAlign(e,n)),r.align&&ma.applyAlign(e,n,r.align),r.valign&&ma.applyVAlign(e,n,r.valign)}),e.focus()})},ba=function(e){var t,n,r,o=[];if(o=e.dom.select("td[data-mce-selected],th[data-mce-selected]"),t=e.dom.getParent(e.selection.getStart(),"td,th"),!o.length&&t&&o.push(t),t=t||o[0]){n=o.length>1?{width:"",height:"",scope:"",class:"",align:"",valign:"",style:"",type:t.nodeName.toLowerCase()}:function(e,t){var n=e.dom,r={width:n.getStyle(t,"width")||n.getAttrib(t,"width"),height:n.getStyle(t,"height")||n.getAttrib(t,"height"),scope:n.getAttrib(t,"scope"),class:n.getAttrib(t,"class"),type:t.nodeName.toLowerCase(),style:"",align:"",valign:""};return da.each("left center right".split(" "),function(n){e.formatter.matchNode(t,"align"+n)&&(r.align=n)}),da.each("top middle bottom".split(" "),function(n){e.formatter.matchNode(t,"valign"+n)&&(r.valign=n)}),Qu(e)&&da.extend(r,pa.extractAdvancedStyles(n,t)),r}(e,t),na(e).length>0&&(r={name:"class",type:"listbox",label:"Class",values:pa.buildListItems(na(e),function(t){t.value&&(t.textStyle=function(){return e.formatter.getCssText({block:"td",classes:[t.value]})})})});var u={type:"form",layout:"flex",direction:"column",labelGapCalc:"children",padding:0,items:[{type:"form",layout:"grid",columns:2,labelGapCalc:!1,padding:0,defaults:{type:"textbox",maxWidth:50},items:[{label:"Width",name:"width",onchange:i(pa.updateStyleField,e)},{label:"Height",name:"height",onchange:i(pa.updateStyleField,e)},{label:"Cell type",name:"type",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"Cell",value:"td"},{text:"Header cell",value:"th"}]},{label:"Scope",name:"scope",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"None",value:""},{text:"Row",value:"row"},{text:"Column",value:"col"},{text:"Row group",value:"rowgroup"},{text:"Column group",value:"colgroup"}]},{label:"H Align",name:"align",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{label:"V Align",name:"valign",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"None",value:""},{text:"Top",value:"top"},{text:"Middle",value:"middle"},{text:"Bottom",value:"bottom"}]}]},r]};Qu(e)?e.windowManager.open({title:"Cell properties",bodyType:"tabpanel",data:n,body:[{title:"General",type:"form",items:u},pa.createStyleForm(e)],onsubmit:i(va,e,o)}):e.windowManager.open({title:"Cell properties",data:n,body:u,onsubmit:i(va,e,o)})}},wa=function(e,t,n){var r=e.getParent(t,"table"),o=t.parentNode,i=e.select(n,r)[0];i||(i=e.create(n),r.firstChild?"CAPTION"===r.firstChild.nodeName?e.insertAfter(i,r.firstChild):r.insertBefore(i,r.firstChild):r.appendChild(i)),i.appendChild(t),o.hasChildNodes()||e.remove(o)};function ya(e,t,n,r){var o=e.dom;function i(e,n,r){(1===t.length||r)&&o.setAttrib(e,n,r)}Zu(e)&&pa.syncAdvancedStyleFields(e,r);var u=r.control.rootControl.toJSON();e.undoManager.transact(function(){da.each(t,function(r){i(r,"scope",u.scope),i(r,"style",u.style),i(r,"class",u.class),function(e,n,r){(1===t.length||r)&&o.setStyle(e,n,r)}(r,"height",qu(u.height)),u.type!==r.parentNode.nodeName.toLowerCase()&&wa(e.dom,r,u.type),u.align!==n.align&&(ma.unApplyAlign(e,r),ma.applyAlign(e,r,u.align))}),e.focus()})}var xa=function(e){var t,n,r,o,u,a,c=e.dom,l=[];t=c.getParent(e.selection.getStart(),"table"),n=c.getParent(e.selection.getStart(),"td,th"),da.each(t.rows,function(e){da.each(e.cells,function(t){if(c.getAttrib(t,"data-mce-selected")||t===n)return l.push(e),!1})}),(r=l[0])&&(u=l.length>1?{height:"",scope:"",style:"",class:"",align:"",type:r.parentNode.nodeName.toLowerCase()}:function(e,t){var n=e.dom,r={height:n.getStyle(t,"height")||n.getAttrib(t,"height"),scope:n.getAttrib(t,"scope"),class:n.getAttrib(t,"class"),align:"",style:"",type:t.parentNode.nodeName.toLowerCase()};return da.each("left center right".split(" "),function(n){e.formatter.matchNode(t,"align"+n)&&(r.align=n)}),Zu(e)&&da.extend(r,pa.extractAdvancedStyles(n,t)),r}(e,r),ra(e).length>0&&(o={name:"class",type:"listbox",label:"Class",values:pa.buildListItems(ra(e),function(t){t.value&&(t.textStyle=function(){return e.formatter.getCssText({block:"tr",classes:[t.value]})})})}),a={type:"form",columns:2,padding:0,defaults:{type:"textbox"},items:[{type:"listbox",name:"type",label:"Row type",text:"Header",maxWidth:null,values:[{text:"Header",value:"thead"},{text:"Body",value:"tbody"},{text:"Footer",value:"tfoot"}]},{type:"listbox",name:"align",label:"Alignment",text:"None",maxWidth:null,values:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{label:"Height",name:"height"},o]},Zu(e)?e.windowManager.open({title:"Row properties",data:u,bodyType:"tabpanel",body:[{title:"General",type:"form",items:a},pa.createStyleForm(e)],onsubmit:i(ya,e,l,u)}):e.windowManager.open({title:"Row properties",data:u,body:a,onsubmit:i(ya,e,l,u)}))},Ca=tinymce.util.Tools.resolve("tinymce.Env"),Sa={styles:{"border-collapse":"collapse",width:"100%"},attributes:{border:"1"},percentages:!0},Ra=function(e,t,n,r,o){void 0===o&&(o=Sa);var i=oe.fromTag("table");Mt.setAll(i,o.styles),at.setAll(i,o.attributes);var u=oe.fromTag("tbody");jt.append(i,u);for(var a=[],c=0;c<e;c++){for(var l=oe.fromTag("tr"),f=0;f<t;f++){var s=c<n||f<r?oe.fromTag("th"):oe.fromTag("td");f<r&&at.set(s,"scope","row"),c<n&&at.set(s,"scope","col"),jt.append(s,oe.fromTag("br")),o.percentages&&Mt.set(s,"width",100/t+"%"),jt.append(l,s)}a.push(l)}return qt.append(u,a),i},Ta=function(e){return e.dom().innerHTML},Na=function(e){var t=oe.fromTag("div"),n=oe.fromDom(e.dom().cloneNode(!0));return jt.append(t,n),Ta(t)},Ea=function(e,t){e.selection.select(t.dom(),!0),e.selection.collapse(!0)},Da=function(e,t,n){var r=Ju(e),o={styles:r,attributes:function(e){return e.getParam("table_default_attributes",Ku,"object")}(e),percentages:function(e){return v(e)&&-1!==e.indexOf("%")}(r.width)&&!ia(e)},u=Ra(n,t,0,0,o);at.set(u,"data-mce-id","__mce");var a=Na(u);return e.insertContent(a),yt.descendant(Mu(e),'table[data-mce-id="__mce"]').map(function(t){return ia(e)&&Mt.set(t,"width",Mt.get(t,"width")),at.remove(t,"data-mce-id"),function(e,t){N(mt.descendants(t,"tr"),function(t){ua(e,t.dom()),N(mt.descendants(t,"th,td"),function(t){aa(e,t.dom())})})}(e,t),function(e,t){yt.descendant(t,"td,th").each(i(Ea,e))}(e,t),t.dom()}).getOr(null)};function Oa(e,t,n,r){if("TD"===t.tagName||"TH"===t.tagName)e.setStyle(t,n,r);else if(t.children)for(var o=0;o<t.children.length;o++)Oa(e,t.children[o],n,r)}var Aa=function(e,t,n){var r,o,i=e.dom;ea(e)&&pa.syncAdvancedStyleFields(e,n),!1===(o=n.control.rootControl.toJSON()).class&&delete o.class,e.undoManager.transact(function(){t||(t=Da(e,o.cols||1,o.rows||1)),function(e,t,n){var r=e.dom,o={},i={};if(o.class=n.class,i.height=qu(n.height),r.getAttrib(t,"width")&&!ta(e)?o.width=function(e){return e?e.replace(/px$/,""):""}(n.width):i.width=qu(n.width),ta(e)?(i["border-width"]=qu(n.border),i["border-spacing"]=qu(n.cellspacing),da.extend(o,{"data-mce-border-color":n.borderColor,"data-mce-cell-padding":n.cellpadding,"data-mce-border":n.border})):da.extend(o,{border:n.border,cellpadding:n.cellpadding,cellspacing:n.cellspacing}),ta(e)&&t.children)for(var u=0;u<t.children.length;u++)Oa(r,t.children[u],{"border-width":qu(n.border),"border-color":n.borderColor,padding:qu(n.cellpadding)});n.style?da.extend(i,r.parseStyle(n.style)):i=da.extend({},r.parseStyle(r.getAttrib(t,"style")),i),o.style=r.serializeStyle(i),r.setAttribs(t,o)}(e,t,o),(r=i.select("caption",t)[0])&&!o.caption&&i.remove(r),!r&&o.caption&&((r=i.create("caption")).innerHTML=Ca.ie?"Â ":'<br data-mce-bogus="1"/>',t.insertBefore(r,t.firstChild)),ma.unApplyAlign(e,t),o.align&&ma.applyAlign(e,t,o.align),e.focus(),e.addVisual()})},ka=function(e,t){var n,r,o,u,a,c=e.dom,l={};!0===t?(n=c.getParent(e.selection.getStart(),"table"))&&(l=function(e,t){var n=e.dom,r={width:n.getStyle(t,"width")||n.getAttrib(t,"width"),height:n.getStyle(t,"height")||n.getAttrib(t,"height"),cellspacing:n.getStyle(t,"border-spacing")||n.getAttrib(t,"cellspacing"),cellpadding:n.getAttrib(t,"data-mce-cell-padding")||n.getAttrib(t,"cellpadding")||ma.getTDTHOverallStyle(e.dom,t,"padding"),border:n.getAttrib(t,"data-mce-border")||n.getAttrib(t,"border")||ma.getTDTHOverallStyle(e.dom,t,"border"),borderColor:n.getAttrib(t,"data-mce-border-color"),caption:!!n.select("caption",t)[0],class:n.getAttrib(t,"class")};return da.each("left center right".split(" "),function(n){e.formatter.matchNode(t,"align"+n)&&(r.align=n)}),ea(e)&&da.extend(r,pa.extractAdvancedStyles(n,t)),r}(e,n)):(r={label:"Cols",name:"cols"},o={label:"Rows",name:"rows"}),oa(e).length>0&&(l.class&&(l.class=l.class.replace(/\s*mce\-item\-table\s*/g,"")),u={name:"class",type:"listbox",label:"Class",values:pa.buildListItems(oa(e),function(t){t.value&&(t.textStyle=function(){return e.formatter.getCssText({block:"table",classes:[t.value]})})})}),a={type:"form",layout:"flex",direction:"column",labelGapCalc:"children",padding:0,items:[{type:"form",labelGapCalc:!1,padding:0,layout:"grid",columns:2,defaults:{type:"textbox",maxWidth:50},items:function(e){return e.getParam("table_appearance_options",!0,"boolean")}(e)?[r,o,{label:"Width",name:"width",onchange:i(pa.updateStyleField,e)},{label:"Height",name:"height",onchange:i(pa.updateStyleField,e)},{label:"Cell spacing",name:"cellspacing"},{label:"Cell padding",name:"cellpadding"},{label:"Border",name:"border"},{label:"Caption",name:"caption",type:"checkbox"}]:[r,o,{label:"Width",name:"width",onchange:i(pa.updateStyleField,e)},{label:"Height",name:"height",onchange:i(pa.updateStyleField,e)}]},{label:"Alignment",name:"align",type:"listbox",text:"None",values:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},u]},ea(e)?e.windowManager.open({title:"Table properties",data:l,bodyType:"tabpanel",body:[{title:"General",type:"form",items:a},pa.createStyleForm(e)],onsubmit:i(Aa,e,n)}):e.windowManager.open({title:"Table properties",data:l,body:a,onsubmit:i(Aa,e,n)})},Pa=da.each,Ia={registerCommands:function(e,n,r,o,a){var c=ju(e),l=function(){return oe.fromDom(e.dom.getParent(e.selection.getStart(),"th,td"))},f=function(e){return Rt.table(e,c)},s=function(e){return{width:_u(e.dom()),height:_u(e.dom())}},d=function(t){var n=l();f(n).each(function(i){var u=gr.forMenu(o,i,n),a=s(i);t(i,u).each(function(t){!function(e,t,n){var r=s(n);t.width===r.width&&t.height===r.height||(ca(e,n.dom(),t.width,t.height),la(e,n.dom(),r.width,r.height))}(e,a,i),e.selection.setRng(t),e.focus(),r.clear(i),Fu(i)})})},m=function(n){var r=l();return f(r).bind(function(n){var i=oe.fromDom(e.getDoc()),u=gr.forMenu(o,n,r),a=dn(t,i,h.none());return sa(n,u,a)})},g=function(t){a.get().each(function(n){var i=T(n,function(e){return $t(e)}),u=l();f(u).bind(function(n){var a=oe.fromDom(e.getDoc()),c=mn(a),l=gr.pasteRows(o,n,u,i,c);t(n,l).each(function(t){e.selection.setRng(t),e.focus(),r.clear(n)})})})};Pa({mceTableSplitCells:function(){d(n.unmergeCells)},mceTableMergeCells:function(){d(n.mergeCells)},mceTableInsertRowBefore:function(){d(n.insertRowsBefore)},mceTableInsertRowAfter:function(){d(n.insertRowsAfter)},mceTableInsertColBefore:function(){d(n.insertColumnsBefore)},mceTableInsertColAfter:function(){d(n.insertColumnsAfter)},mceTableDeleteCol:function(){d(n.deleteColumn)},mceTableDeleteRow:function(){d(n.deleteRow)},mceTableCutRow:function(e){a.set(m()),d(n.deleteRow)},mceTableCopyRow:function(e){a.set(m())},mceTablePasteRowBefore:function(e){g(n.pasteRowsBefore)},mceTablePasteRowAfter:function(e){g(n.pasteRowsAfter)},mceTableDelete:function(){var t=oe.fromDom(e.dom.getParent(e.selection.getStart(),"th,td"));Rt.table(t,c).filter(u(c)).each(function(t){var n=oe.fromText("");jt.after(t,n),Ht.remove(t);var r=e.dom.createRng();r.setStart(n.dom(),0),r.setEnd(n.dom(),0),e.selection.setRng(r)})}},function(t,n){e.addCommand(n,t)}),Pa({mceInsertTable:i(ka,e),mceTableProps:i(ka,e,!0),mceTableRowProps:i(xa,e),mceTableCellProps:i(ba,e)},function(t,n){e.addCommand(n,function(e,n){t(n)})})}},Ba=function(e){var t=h.from(e.dom().documentElement).map(oe.fromDom).getOr(e);return{parent:r(t),view:r(e),origin:r(qr(0,0))}},Wa=function(e,t){return{parent:r(t),view:r(e),origin:r(qr(0,0))}};function Ma(e){var t=z.apply(null,e),n=[];return{bind:function(e){if(void 0===e)throw"Event bind error: undefined handler";n.push(e)},unbind:function(e){n=E(n,function(t){return t!==e})},trigger:function(){var e=t.apply(null,arguments);N(n,function(t){t(e)})}}}var _a={create:function(e){return{registry:F(e,function(e){return{bind:e.bind,unbind:e.unbind}}),trigger:F(e,function(e){return e.trigger})}}},La={mode:ao(["compare","extract","mutate","sink"]),sink:ao(["element","start","stop","destroy"]),api:ao(["forceDrop","drop","move","delayDrop"])},ja={resolve:Yo("ephox-dragster").resolve},qa=function(e,t){return function(o){if(e(o)){var i=oe.fromDom(o.target),u=function(){o.stopPropagation()},a=function(){o.preventDefault()},c=n(a,u),l=function(e,t,n,o,i,u,a){return{target:r(e),x:r(t),y:r(n),stop:o,prevent:i,kill:u,raw:r(a)}}(i,o.clientX,o.clientY,u,a,c,o);t(l)}}},Fa=function(e,t,n,r,o){var u=qa(n,r);return e.dom().addEventListener(t,u,o),{unbind:i(Ha,e,t,u,o)}},Ha=function(e,t,n,r){e.dom().removeEventListener(t,n,r)},za=function(e,t,n,r){return Fa(e,t,n,r,!1)},Ua=function(e,t,n,r){return Fa(e,t,n,r,!0)},Va=r(!0),Ga={bind:function(e,t,n){return za(e,t,Va,n)},capture:function(e,t,n){return Ua(e,t,Va,n)}},Ya=La.mode({compare:function(e,t){return qr(t.left()-e.left(),t.top()-e.top())},extract:function(e){return h.some(qr(e.x(),e.y()))},sink:function(e,t){var n=function(e){var t=No({layerClass:ja.resolve("blocker")},e),n=oe.fromTag("div");return at.set(n,"role","presentation"),Mt.setAll(n,{position:"fixed",left:"0px",top:"0px",width:"100%",height:"100%"}),ci.add(n,ja.resolve("blocker")),ci.add(n,t.layerClass),{element:function(){return n},destroy:function(){Ht.remove(n)}}}(t),r=Ga.bind(n.element(),"mousedown",e.forceDrop),o=Ga.bind(n.element(),"mouseup",e.drop),i=Ga.bind(n.element(),"mousemove",e.move),u=Ga.bind(n.element(),"mouseout",e.delayDrop);return La.sink({element:n.element,start:function(e){jt.append(e,n.element())},stop:function(){Ht.remove(n.element())},destroy:function(){n.destroy(),o.unbind(),i.unbind(),u.unbind(),r.unbind()}})},mutate:function(e,t){e.mutate(t.left(),t.top())}});function Xa(){var e=h.none(),t=_a.create({move:Ma(["info"])});return{onEvent:function(n,r){r.extract(n).each(function(n){(function(t,n){var r=e.map(function(e){return t.compare(e,n)});return e=h.some(n),r})(r,n).each(function(e){t.trigger.move(e)})})},reset:function(){e=h.none()},events:t.registry}}function Ka(){var e={onEvent:function(e,t){},reset:t},n=Xa(),r=e;return{on:function(){r.reset(),r=n},off:function(){r.reset(),r=e},isOn:function(){return r===n},onEvent:function(e,t){r.onEvent(e,t)},events:n.events}}var Ja=function(e,t,n){var r=!1,o=_a.create({start:Ma([]),stop:Ma([])}),i=Ka(),u=function(){l.stop(),i.isOn()&&(i.off(),o.trigger.stop())},a=function(e,t){var n=null;return{cancel:function(){null!==n&&(clearTimeout(n),n=null)},throttle:function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];null!==n&&clearTimeout(n),n=setTimeout(function(){e.apply(null,r),n=null},t)}}}(u,200);i.events.move.bind(function(n){t.mutate(e,n.info())});var c=function(e){return function(){var t=Array.prototype.slice.call(arguments,0);if(r)return e.apply(null,t)}},l=t.sink(La.api({forceDrop:u,drop:c(u),move:c(function(e,n){a.cancel(),i.onEvent(e,t)}),delayDrop:c(a.throttle)}),n);return{element:l.element,go:function(e){l.start(e),i.on(),o.trigger.start()},on:function(){r=!0},off:function(){r=!1},destroy:function(){l.destroy()},events:o.registry}},$a={transform:function(e,t){var n=void 0!==t?t:{},r=void 0!==n.mode?n.mode:Ya;return Ja(e,r,t)}};function Qa(){var e=_a.create({drag:Ma(["xDelta","yDelta","target"])}),t=h.none(),n=function(){var e=_a.create({drag:Ma(["xDelta","yDelta"])});return{mutate:function(t,n){e.trigger.drag(t,n)},events:e.registry}}();return n.events.drag.bind(function(n){t.each(function(t){e.trigger.drag(n.xDelta(),n.yDelta(),t)})}),{assign:function(e){t=h.some(e)},get:function(){return t},mutate:n.mutate,events:e.registry}}var Za={any:function(e){return yt.first(e).isSome()},ancestor:function(e,t,n){return yt.ancestor(e,t,n).isSome()},sibling:function(e,t){return yt.sibling(e,t).isSome()},child:function(e,t){return yt.child(e,t).isSome()},descendant:function(e,t){return yt.descendant(e,t).isSome()},closest:function(e,t,n){return yt.closest(e,t,n).isSome()}},ec=Xo.resolve("resizer-bar-dragging");function tc(e,t){var n=eo.height,r=function(e,t,n){var r=Qa(),o=$a.transform(r,{}),u=h.none(),a=function(e,t){return h.from(at.get(e,t))};r.events.drag.bind(function(e){a(e.target(),"data-row").each(function(t){var n=cu.getInt(e.target(),"top");Mt.set(e.target(),"top",n+e.yDelta()+"px")}),a(e.target(),"data-column").each(function(t){var n=cu.getInt(e.target(),"left");Mt.set(e.target(),"left",n+e.xDelta()+"px")})});var c=function(e,t){return cu.getInt(e,t)-parseInt(at.get(e,"data-initial-"+t),10)};o.events.stop.bind(function(){r.get().each(function(r){u.each(function(o){a(r,"data-row").each(function(e){var t=c(r,"top");at.remove(r,"data-initial-top"),m.trigger.adjustHeight(o,t,parseInt(e,10))}),a(r,"data-column").each(function(e){var t=c(r,"left");at.remove(r,"data-initial-left"),m.trigger.adjustWidth(o,t,parseInt(e,10))}),pi.refresh(e,o,n,t)})})});var l=function(t,n){m.trigger.startAdjust(),r.assign(t),at.set(t,"data-initial-"+n,parseInt(Mt.get(t,n),10)),ci.add(t,ec),Mt.set(t,"opacity","0.2"),o.go(e.parent())},f=Ga.bind(e.parent(),"mousedown",function(e){pi.isRowBar(e.target())&&l(e.target(),"top"),pi.isColBar(e.target())&&l(e.target(),"left")}),s=function(t){return qe.eq(t,e.view())},d=Ga.bind(e.view(),"mouseover",function(r){"table"===nt.name(r.target())||Za.closest(r.target(),"table",s)?(u="table"===nt.name(r.target())?h.some(r.target()):yt.ancestor(r.target(),"table",s)).each(function(r){pi.refresh(e,r,n,t)}):ft.inBody(r.target())&&pi.destroy(e)}),m=_a.create({adjustHeight:Ma(["table","delta","row"]),adjustWidth:Ma(["table","delta","column"]),startAdjust:Ma([])});return{destroy:function(){f.unbind(),d.unbind(),o.destroy(),pi.destroy(e)},refresh:function(r){pi.refresh(e,r,n,t)},on:o.on,off:o.off,hideBars:i(pi.hide,e),showBars:i(pi.show,e),events:m.registry}}(e,t,n),o=_a.create({beforeResize:Ma(["table"]),afterResize:Ma(["table"]),startDrag:Ma([])});return r.events.adjustHeight.bind(function(e){o.trigger.beforeResize(e.table());var t=n.delta(e.delta(),e.table());Tu.adjustHeight(e.table(),t,e.row(),n),o.trigger.afterResize(e.table())}),r.events.startAdjust.bind(function(e){o.trigger.startDrag()}),r.events.adjustWidth.bind(function(e){o.trigger.beforeResize(e.table());var n=t.delta(e.delta(),e.table());Tu.adjustWidth(e.table(),n,e.column(),t),o.trigger.afterResize(e.table())}),{on:r.on,off:r.off,hideBars:r.hideBars,showBars:r.showBars,destroy:r.destroy,events:o.registry}}var nc=function(e,t){return e.inline?Wa(Mu(e),function(){var e=oe.fromTag("div");return Mt.setAll(e,{position:"static",height:"0",width:"0",padding:"0",margin:"0",border:"0"}),jt.append(ft.body(),e),e}()):Ba(oe.fromDom(e.getDoc()))},rc=function(e,t){e.inline&&Ht.remove(t.parent())},oc=function(e){var t,n,r=h.none(),o=h.none(),i=h.none(),u=/(\d+(\.\d+)?)%/,a=function(e){return"TABLE"===e.nodeName};return e.on("init",function(){var t=no(Gu.directionAt),n=nc(e);if(i=h.some(n),function(e){var t=e.getParam("object_resizing",!0);return"table"===t||t}(e)&&function(e){return e.getParam("table_resize_bars",!0,"boolean")}(e)){var u=tc(n,t);u.on(),u.events.startDrag.bind(function(t){r=h.some(e.selection.getRng())}),u.events.beforeResize.bind(function(t){var n=t.table().dom();ca(e,n,_u(n),Lu(n))}),u.events.afterResize.bind(function(t){var n=t.table(),o=n.dom();Fu(n),r.each(function(t){e.selection.setRng(t),e.focus()}),la(e,o,_u(o),Lu(o)),e.undoManager.add()}),o=h.some(u)}}),e.on("ObjectResizeStart",function(r){var o=r.target;a(o)&&(t=r.width,n=function(t){return e.dom.getStyle(t,"width")||e.dom.getAttrib(t,"width")}(o))}),e.on("ObjectResized",function(r){var o=r.target;if(a(o)){var i=o;if(u.test(n)){var c=parseFloat(u.exec(n)[1]),l=r.width*c/t;e.dom.setStyle(i,"width",l+"%")}else{var f=[];da.each(i.rows,function(t){da.each(t.cells,function(t){var n=e.dom.getStyle(t,"width",!0);f.push({cell:t,width:n})})}),da.each(f,function(t){e.dom.setStyle(t.cell,"width",t.width),e.dom.setAttrib(t.cell,"width",null)})}}}),{lazyResize:function(){return o},lazyWire:function(){return i.getOr(Ba(oe.fromDom(e.getBody())))},destroy:function(){o.each(function(e){e.destroy()}),i.each(function(t){rc(e,t)})}}},ic=function(e){return{fold:e}},uc=function(e){return ic(function(t,n,r,o){return t(e)})},ac=function(e){return ic(function(t,n,r,o){return n(e)})},cc=function(e,t){return ic(function(n,r,o,i){return o(e,t)})},lc=function(e){return ic(function(t,n,r,o){return o(e)})},fc=function(e,t){return Rt.table(e,t).bind(function(t){var n=Rt.cells(t);return k(n,function(t){return qe.eq(e,t)}).map(function(e){return{index:r(e),all:r(n)}})})},sc=function(e,t){return fc(e,t).fold(function(){return uc(e)},function(t){return t.index()+1<t.all().length?cc(e,t.all()[t.index()+1]):lc(e)})},dc=function(e,t){return fc(e,t).fold(function(){return uc()},function(t){return t.index()-1>=0?cc(e,t.all()[t.index()-1]):ac(e)})},mc=ir([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),gc={before:mc.before,on:mc.on,after:mc.after,cata:function(e,t,n,r){return e.fold(t,n,r)},getStart:function(e){return e.fold(o,o,o)}},hc=ir([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),pc=z("start","soffset","finish","foffset"),vc={domRange:hc.domRange,relative:hc.relative,exact:hc.exact,exactFromRange:function(e){return hc.exact(e.start(),e.soffset(),e.finish(),e.foffset())},range:pc,getWin:function(e){var t=function(e){return e.match({domRange:function(e){return oe.fromDom(e.startContainer)},relative:function(e,t){return gc.getStart(e)},exact:function(e,t,n,r){return e}})}(e);return Ye.defaultView(t)}},bc=function(e,t,n,r){var o=Ye.owner(e).dom().createRange();return o.setStart(e.dom(),t),o.setEnd(n.dom(),r),o},wc=function(e,t,n,r){var o=bc(e,t,n,r),i=qe.eq(e,n)&&t===r;return o.collapsed&&!i},yc=function(e,t){var n=(t||document).createDocumentFragment();return N(e,function(e){n.appendChild(e.dom())}),oe.fromDom(n)},xc=function(e,t){e.selectNodeContents(t.dom())},Cc=function(e){e.deleteContents()},Sc=function(e){return{left:r(e.left),top:r(e.top),right:r(e.right),bottom:r(e.bottom),width:r(e.width),height:r(e.height)}},Rc={create:function(e){return e.document.createRange()},replaceWith:function(e,t){Cc(e),e.insertNode(t.dom())},selectNodeContents:function(e,t){var n=e.document.createRange();return xc(n,t),n},selectNodeContentsUsing:xc,relativeToNative:function(e,t,n){var r=e.document.createRange();return function(e,t){t.fold(function(t){e.setStartBefore(t.dom())},function(t,n){e.setStart(t.dom(),n)},function(t){e.setStartAfter(t.dom())})}(r,t),function(e,t){t.fold(function(t){e.setEndBefore(t.dom())},function(t,n){e.setEnd(t.dom(),n)},function(t){e.setEndAfter(t.dom())})}(r,n),r},exactToNative:function(e,t,n,r,o){var i=e.document.createRange();return i.setStart(t.dom(),n),i.setEnd(r.dom(),o),i},deleteContents:Cc,cloneFragment:function(e){var t=e.cloneContents();return oe.fromDom(t)},getFirstRect:function(e){var t=e.getClientRects(),n=t.length>0?t[0]:e.getBoundingClientRect();return n.width>0||n.height>0?h.some(n).map(Sc):h.none()},getBounds:function(e){var t=e.getBoundingClientRect();return t.width>0||t.height>0?h.some(t).map(Sc):h.none()},isWithin:function(e,t){return t.compareBoundaryPoints(e.END_TO_START,e)<1&&t.compareBoundaryPoints(e.START_TO_END,e)>-1},toString:function(e){return e.toString()}},Tc=ir([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),Nc=function(e,t,n){return t(oe.fromDom(n.startContainer),n.startOffset,oe.fromDom(n.endContainer),n.endOffset)},Ec=function(e,t){return function(e,t){var n=t.ltr();return n.collapsed?t.rtl().filter(function(e){return!1===e.collapsed}).map(function(e){return Tc.rtl(oe.fromDom(e.endContainer),e.endOffset,oe.fromDom(e.startContainer),e.startOffset)}).getOrThunk(function(){return Nc(0,Tc.ltr,n)}):Nc(0,Tc.ltr,n)}(0,function(e,t){return t.match({domRange:function(e){return{ltr:r(e),rtl:h.none}},relative:function(t,n){return{ltr:ve(function(){return Rc.relativeToNative(e,t,n)}),rtl:ve(function(){return h.some(Rc.relativeToNative(e,n,t))})}},exact:function(t,n,r,o){return{ltr:ve(function(){return Rc.exactToNative(e,t,n,r,o)}),rtl:ve(function(){return h.some(Rc.exactToNative(e,r,o,t,n))})}}})}(e,t))},Dc={ltr:Tc.ltr,rtl:Tc.rtl,diagnose:Ec,asLtrRange:function(e,t){return Ec(e,t).match({ltr:function(t,n,r,o){var i=e.document.createRange();return i.setStart(t.dom(),n),i.setEnd(r.dom(),o),i},rtl:function(t,n,r,o){var i=e.document.createRange();return i.setStart(r.dom(),o),i.setEnd(t.dom(),n),i}})}},Oc=function(e,t,n){return t>=e.left&&t<=e.right&&n>=e.top&&n<=e.bottom},Ac=function(e,t,n,r,o){if(0===o)return 0;if(t===r)return o-1;for(var i=r,u=1;u<o;u++){var a=e(u),c=Math.abs(t-a.left);if(n<=a.bottom){if(n<a.top||c>i)return u-1;i=c}}return 0},kc={locate:function(e,t,n,r){var o=e.dom().createRange();o.selectNode(t.dom());var i=o.getClientRects();return Do(i,function(e){return Oc(e,n,r)?h.some(e):h.none()}).map(function(o){return function(e,t,n,r,o){var i=function(n){var r=e.dom().createRange();return r.setStart(t.dom(),n),r.collapse(!0),r},u=en.get(t).length,a=Ac(function(e){return i(e).getBoundingClientRect()},n,r,o.right,u);return i(a)}(e,t,n,r,o)})}},Pc=function(e,t,n,r){var o=e.dom().createRange(),i=Ye.children(t);return Do(i,function(t){return o.selectNode(t.dom()),Oc(o.getBoundingClientRect(),n,r)?Ic(e,t,n,r):h.none()})},Ic=function(e,t,n,r){return(nt.isText(t)?kc.locate:Pc)(e,t,n,r)},Bc=function(e,t,n,r){var o=e.dom().createRange();o.selectNode(t.dom());var i=o.getBoundingClientRect(),u=Math.max(i.left,Math.min(i.right,n)),a=Math.max(i.top,Math.min(i.bottom,r));return Ic(e,t,u,a)},Wc=function(e,t){return t-e.left<e.right-t},Mc=function(e,t,n){var r=e.dom().createRange();return r.selectNode(t.dom()),r.collapse(n),r},_c=function(e,t,n){var r=e.dom().createRange();r.selectNode(t.dom());var o=r.getBoundingClientRect(),i=Wc(o,n);return(!0===i?an.first:an.last)(t).map(function(t){return Mc(e,t,i)})},Lc=function(e,t,n){var r=t.dom().getBoundingClientRect(),o=Wc(r,n);return h.some(Mc(e,t,o))},jc=function(e,t,n){return(0===Ye.children(t).length?Lc:_c)(e,t,n)},qc=document.caretPositionFromPoint?function(e,t,n){return h.from(e.dom().caretPositionFromPoint(t,n)).bind(function(t){if(null===t.offsetNode)return h.none();var n=e.dom().createRange();return n.setStart(t.offsetNode,t.offset),n.collapse(),h.some(n)})}:document.caretRangeFromPoint?function(e,t,n){return h.from(e.dom().caretRangeFromPoint(t,n))}:function(e,t,n){return oe.fromPoint(e,t,n).bind(function(r){var o=function(){return jc(e,r,t)};return 0===Ye.children(r).length?o():function(e,t,n,r){var o=e.dom().createRange();o.selectNode(t.dom());var i=o.getBoundingClientRect(),u=Math.max(i.left,Math.min(i.right,n)),a=Math.max(i.top,Math.min(i.bottom,r));return Bc(e,t,u,a)}(e,r,t,n).orThunk(o)})},Fc=function(e,t,n){var r=oe.fromDom(e.document);return qc(r,t,n).map(function(e){return vc.range(oe.fromDom(e.startContainer),e.startOffset,oe.fromDom(e.endContainer),e.endOffset)})},Hc=function(e,t,n){var r=Dc.asLtrRange(e,t),o=oe.fromDom(r.commonAncestorContainer);return nt.isElement(o)?function(e,t,n,r){var o=Rc.create(e),i=(le.is(t,r)?[t]:[]).concat(mt.descendants(t,r));return E(i,function(e){return Rc.selectNodeContentsUsing(o,e),Rc.isWithin(n,o)})}(e,o,r,n):[]},zc=function(e,t){var n=nt.name(e);return"input"===n?gc.after(e):S(["br","img"],n)?0===t?gc.before(e):gc.after(e):gc.on(e,t)},Uc=function(e,t){var n=e.fold(gc.before,zc,gc.after),r=t.fold(gc.before,zc,gc.after);return vc.relative(n,r)},Vc=function(e,t,n,r){var o=zc(e,t),i=zc(n,r);return vc.relative(o,i)},Gc=function(e){return e.match({domRange:function(e){var t=oe.fromDom(e.startContainer),n=oe.fromDom(e.endContainer);return Vc(t,e.startOffset,n,e.endOffset)},relative:Uc,exact:Vc})},Yc=Uc,Xc=Vc,Kc=function(e,t){h.from(e.getSelection()).each(function(e){e.removeAllRanges(),e.addRange(t)})},Jc=function(e,t,n,r,o){var i=Rc.exactToNative(e,t,n,r,o);Kc(e,i)},$c=function(e,t){return Dc.diagnose(e,t).match({ltr:function(t,n,r,o){Jc(e,t,n,r,o)},rtl:function(t,n,r,o){var i=e.getSelection();if(i.setBaseAndExtent)i.setBaseAndExtent(t.dom(),n,r.dom(),o);else if(i.extend)try{!function(e,t,n,r,o,i){t.collapse(n.dom(),r),t.extend(o.dom(),i)}(0,i,t,n,r,o)}catch(i){Jc(e,r,o,t,n)}else Jc(e,r,o,t,n)}})},Qc=function(e){var t=oe.fromDom(e.anchorNode),n=oe.fromDom(e.focusNode);return wc(t,e.anchorOffset,n,e.focusOffset)?h.some(vc.range(oe.fromDom(e.anchorNode),e.anchorOffset,oe.fromDom(e.focusNode),e.focusOffset)):function(e){if(e.rangeCount>0){var t=e.getRangeAt(0),n=e.getRangeAt(e.rangeCount-1);return h.some(vc.range(oe.fromDom(t.startContainer),t.startOffset,oe.fromDom(n.endContainer),n.endOffset))}return h.none()}(e)},Zc=function(e){return h.from(e.getSelection()).filter(function(e){return e.rangeCount>0}).bind(Qc)},el={setExact:function(e,t,n,r,o){var i=Xc(t,n,r,o);$c(e,i)},getExact:Zc,get:function(e){return Zc(e).map(function(e){return vc.exact(e.start(),e.soffset(),e.finish(),e.foffset())})},setRelative:function(e,t,n){var r=Yc(t,n);$c(e,r)},toNative:function(e){var t=vc.getWin(e).dom(),n=function(e,n,r,o){return Rc.exactToNative(t,e,n,r,o)},r=Gc(e);return Dc.diagnose(t,r).match({ltr:n,rtl:n})},setToElement:function(e,t){var n=Rc.selectNodeContents(e,t);Kc(e,n)},clear:function(e){e.getSelection().removeAllRanges()},clone:function(e,t){var n=Dc.asLtrRange(e,t);return Rc.cloneFragment(n)},replace:function(e,t,n){var r=Dc.asLtrRange(e,t),o=yc(n,e.document);Rc.replaceWith(r,o)},deleteAt:function(e,t){var n=Dc.asLtrRange(e,t);Rc.deleteContents(n)},forElement:function(e,t){var n=Rc.selectNodeContents(e,t);return vc.range(oe.fromDom(n.startContainer),n.startOffset,oe.fromDom(n.endContainer),n.endOffset)},getFirstRect:function(e,t){var n=Dc.asLtrRange(e,t);return Rc.getFirstRect(n)},getBounds:function(e,t){var n=Dc.asLtrRange(e,t);return Rc.getBounds(n)},getAtPoint:function(e,t,n){return Fc(e,t,n)},findWithin:function(e,t,n){return Hc(e,t,n)},getAsString:function(e,t){var n=Dc.asLtrRange(e,t);return Rc.toString(n)},isCollapsed:function(e,t,n,r){return qe.eq(e,n)&&t===r}},tl=tinymce.util.Tools.resolve("tinymce.util.VK"),nl=function(e,t,n,r){return ul(e,t,sc(n),r)},rl=function(e,t,n,r){return ul(e,t,dc(n),r)},ol=function(e,t){var n=vc.exact(t,0,t,0);return el.toNative(n)},il=function(e,t){return function(e){return 0===e.length?h.none():h.some(e[e.length-1])}(mt.descendants(t,"tr")).bind(function(e){return yt.descendant(e,"td,th").map(function(e){return ol(0,e)})})},ul=function(e,t,n,r,o){return n.fold(h.none,h.none,function(e,t){return an.first(t).map(function(e){return ol(0,e)})},function(n){return Rt.table(n,t).bind(function(t){var o=gr.noMenu(n);return e.undoManager.transact(function(){r.insertRowsAfter(t,o)}),il(0,t)})})},al=["table","li","dl"],cl={handle:function(e,t,n,r){if(e.keyCode===tl.TAB){var o=Mu(t),i=function(e){var t=nt.name(e);return qe.eq(e,o)||S(al,t)},u=t.selection.getRng();if(u.collapsed){var a=oe.fromDom(u.startContainer);Rt.cell(a,i).each(function(o){e.preventDefault(),(e.shiftKey?rl:nl)(t,i,o,n,r).each(function(e){t.selection.setRng(e)})})}}}},ll={response:z("selection","kill")},fl=function(e){return function(t){return t===e}},sl=fl(38),dl=fl(40),ml={ltr:{isBackward:fl(37),isForward:fl(39)},rtl:{isBackward:fl(39),isForward:fl(37)},isUp:sl,isDown:dl,isNavigation:function(e){return e>=37&&e<=40}},gl={convertToRange:function(e,t){var n=Dc.asLtrRange(e,t);return{start:r(oe.fromDom(n.startContainer)),soffset:r(n.startOffset),finish:r(oe.fromDom(n.endContainer)),foffset:r(n.endOffset)}},makeSitus:function(e,t,n,o){return{start:r(gc.on(e,t)),finish:r(gc.on(n,o))}}},hl=_e.detect().browser.isSafari(),pl=function(e){var t=void 0!==e?e.dom():document,n=t.body.scrollLeft||t.documentElement.scrollLeft,r=t.body.scrollTop||t.documentElement.scrollTop;return qr(n,r)},vl=function(e,t,n){(void 0!==n?n.dom():document).defaultView.scrollTo(e,t)},bl=function(e,t){hl&&y(e.dom().scrollIntoViewIfNeeded)?e.dom().scrollIntoViewIfNeeded(!1):e.dom().scrollIntoView(t)},wl={get:pl,to:vl,by:function(e,t,n){(void 0!==n?n.dom():document).defaultView.scrollBy(e,t)},preserve:function(e,t){var n=pl(e);t();var r=pl(e);n.top()===r.top()&&n.left()===r.left()||vl(n.left(),n.top(),e)},capture:function(e){var t=h.none(),n=function(){t=h.some(pl(e))};return n(),{save:n,restore:function(){t.each(function(t){vl(t.left(),t.top(),e)})}}},intoView:bl,intoViewIfNeeded:function(e,t){var n=t.dom().getBoundingClientRect(),r=e.dom().getBoundingClientRect();r.top<n.top?bl(e,!0):r.bottom>n.bottom&&bl(e,!1)},setToElement:function(e,t){var n=zr(t),r=oe.fromDom(e.document);vl(n.left(),n.top(),r)},scrollBarWidth:function(){var e=oe.fromHtml('<div style="width: 100px; height: 100px; overflow: scroll; position: absolute; top: -9999px;"></div>');jt.after(ft.body(),e);var t=e.dom().offsetWidth-e.dom().clientWidth;return Ht.remove(e),t}};function yl(e){return{elementFromPoint:function(t,n){return oe.fromPoint(oe.fromDom(e.document),t,n)},getRect:function(e){return e.dom().getBoundingClientRect()},getRangedRect:function(t,n,r,o){var i=vc.exact(t,n,r,o);return el.getFirstRect(e,i).map(function(e){return F(e,a)})},getSelection:function(){return el.get(e).map(function(t){return gl.convertToRange(e,t)})},fromSitus:function(t){var n=vc.relative(t.start(),t.finish());return gl.convertToRange(e,n)},situsFromPoint:function(t,n){return el.getAtPoint(e,t,n).map(function(e){return{start:r(gc.on(e.start(),e.soffset())),finish:r(gc.on(e.finish(),e.foffset()))}})},clearSelection:function(){el.clear(e)},setSelection:function(t){el.setExact(e,t.start(),t.soffset(),t.finish(),t.foffset())},setRelativeSelection:function(t,n){el.setRelative(e,t,n)},selectContents:function(t){el.setToElement(e,t)},getInnerHeight:function(){return e.innerHeight},getScrollY:function(){return wl.get(oe.fromDom(e.document)).top()},scrollBy:function(t,n){wl.by(t,n,oe.fromDom(e.document))}}}var xl=function(e,t,n,r,o){return qe.eq(n,r)?h.none():er.identify(n,r,t).bind(function(t){var r=t.boxes().getOr([]);return r.length>0?(o(e,r,t.start(),t.finish()),h.some(ll.response(h.some(gl.makeSitus(n,0,n,rn(n))),!0))):h.none()})},Cl={sync:function(e,t,n,r,o,i,u){return qe.eq(n,o)&&r===i?h.none():yt.closest(n,"td,th",t).bind(function(n){return yt.closest(o,"td,th",t).bind(function(r){return xl(e,t,n,r,u)})})},detect:xl,update:function(e,t,n,r,o){return er.shiftSelection(r,e,t,o.firstSelectedSelector(),o.lastSelectedSelector()).map(function(e){return o.clear(n),o.selectRange(n,e.boxes(),e.start(),e.finish()),e.boxes()})}},Sl=K(["left","top","right","bottom"],[]),Rl={nu:Sl,moveUp:function(e,t){return Sl({left:e.left(),top:e.top()-t,right:e.right(),bottom:e.bottom()-t})},moveDown:function(e,t){return Sl({left:e.left(),top:e.top()+t,right:e.right(),bottom:e.bottom()+t})},moveBottomTo:function(e,t){var n=e.bottom()-e.top();return Sl({left:e.left(),top:t-n,right:e.right(),bottom:t})},moveTopTo:function(e,t){var n=e.bottom()-e.top();return Sl({left:e.left(),top:t,right:e.right(),bottom:t+n})},getTop:function(e){return e.top()},getBottom:function(e){return e.bottom()},translate:function(e,t,n){return Sl({left:e.left()+t,top:e.top()+n,right:e.right()+t,bottom:e.bottom()+n})},toString:function(e){return"("+e.left()+", "+e.top()+") -> ("+e.right()+", "+e.bottom()+")"}},Tl=function(e){return Rl.nu({left:e.left,top:e.top,right:e.right,bottom:e.bottom})},Nl=function(e,t){return h.some(e.getRect(t))},El=function(e,t,n){return nt.isElement(t)?Nl(e,t).map(Tl):nt.isText(t)?function(e,t,n){return n>=0&&n<rn(t)?e.getRangedRect(t,n,t,n+1):n>0?e.getRangedRect(t,n-1,t,n):h.none()}(e,t,n).map(Tl):h.none()},Dl=function(e,t){return nt.isElement(t)?Nl(e,t).map(Tl):nt.isText(t)?e.getRangedRect(t,0,t,rn(t)).map(Tl):h.none()},Ol=z("item","mode"),Al=function(e,t,n,r){var o=void 0!==r?r:kl;return e.property().parent(t).map(function(e){return Ol(e,o)})},kl=function(e,t,n,r){var o=void 0!==r?r:Pl;return n.sibling(e,t).map(function(e){return Ol(e,o)})},Pl=function(e,t,n,r){var o=void 0!==r?r:Pl,i=e.property().children(t);return n.first(i).map(function(e){return Ol(e,o)})},Il=[{current:Al,next:kl,fallback:h.none()},{current:kl,next:Pl,fallback:h.some(Al)},{current:Pl,next:Pl,fallback:h.some(kl)}],Bl=function(e,t,n,r,o){return A(o=void 0!==o?o:Il,function(e){return e.current===n}).bind(function(n){return n.current(e,t,r,n.next).orThunk(function(){return n.fallback.bind(function(n){return Bl(e,t,n,r)})})})},Wl={backtrack:Al,sidestep:kl,advance:Pl,go:Bl},Ml={left:function(){return{sibling:function(e,t){return e.query().prevSibling(t)},first:function(e){return e.length>0?h.some(e[e.length-1]):h.none()}}},right:function(){return{sibling:function(e,t){return e.query().nextSibling(t)},first:function(e){return e.length>0?h.some(e[0]):h.none()}}}},_l=function(e,t,n,r,o,i){return Wl.go(e,t,r,o).bind(function(t){return i(t.item())?h.none():n(t.item())?h.some(t.item()):_l(e,t.item(),n,t.mode(),o,i)})},Ll=function(e,t,n,r){return _l(e,t,n,Wl.sidestep,Ml.left(),r)},jl=function(e,t,n,r){return _l(e,t,n,Wl.sidestep,Ml.right(),r)},ql=function(e,t){return 0===e.property().children(t).length},Fl=function(e,t,n,r){return Ll(e,t,n,r)},Hl=function(e,t,n,r){return jl(e,t,n,r)},zl={before:function(e,t,n){return Fl(e,t,i(ql,e),n)},after:function(e,t,n){return Hl(e,t,i(ql,e),n)},seekLeft:Fl,seekRight:Hl,walkers:function(){return{left:Ml.left,right:Ml.right}},walk:function(e,t,n,r,o){return Wl.go(e,t,n,r,o)},backtrack:Wl.backtrack,sidestep:Wl.sidestep,advance:Wl.advance},Ul=pn(),Vl={gather:function(e,t,n){return zl.gather(Ul,e,t,n)},before:function(e,t){return zl.before(Ul,e,t)},after:function(e,t){return zl.after(Ul,e,t)},seekLeft:function(e,t,n){return zl.seekLeft(Ul,e,t,n)},seekRight:function(e,t,n){return zl.seekRight(Ul,e,t,n)},walkers:function(){return zl.walkers()},walk:function(e,t,n,r){return zl.walk(Ul,e,t,n,r)}},Gl=ir([{none:[]},{retry:["caret"]}]),Yl=function(e,t,n){return bt.closest(t,xo).fold(r(!1),function(t){return Dl(e,t).exists(function(e){return function(e,t){return e.left()<t.left()||Math.abs(t.right()-e.left())<1||e.left()>t.right()}(n,e)})})},Xl={point:Rl.getTop,adjuster:function(e,t,n,r,o){var i=Rl.moveUp(o,5);return Math.abs(n.top()-r.top())<1?Gl.retry(i):n.bottom()<o.top()?Gl.retry(i):n.bottom()===o.top()?Gl.retry(Rl.moveUp(o,1)):Yl(e,t,o)?Gl.retry(Rl.translate(i,5,0)):Gl.none()},move:Rl.moveUp,gather:Vl.before},Kl={point:Rl.getBottom,adjuster:function(e,t,n,r,o){var i=Rl.moveDown(o,5);return Math.abs(n.bottom()-r.bottom())<1?Gl.retry(i):n.top()>o.bottom()?Gl.retry(i):n.top()===o.bottom()?Gl.retry(Rl.moveDown(o,1)):Yl(e,t,o)?Gl.retry(Rl.translate(i,5,0)):Gl.none()},move:Rl.moveDown,gather:Vl.after},Jl=function(e,t,n,r,o){return 0===o?h.some(r):function(e,t,n){return e.elementFromPoint(t,n).filter(function(e){return"table"===nt.name(e)}).isSome()}(e,r.left(),t.point(r))?function(e,t,n,r,o){return Jl(e,t,n,t.move(r,5),o)}(e,t,n,r,o-1):e.situsFromPoint(r.left(),t.point(r)).bind(function(i){return i.start().fold(h.none,function(i,u){return Dl(e,i,u).bind(function(u){return t.adjuster(e,i,u,n,r).fold(h.none,function(r){return Jl(e,t,n,r,o-1)})}).orThunk(function(){return h.some(r)})},h.none)})},$l=function(e,t,n){var r=e.move(n,5),o=Jl(t,e,n,r,100).getOr(r);return function(e,t,n){return e.point(t)>n.getInnerHeight()?h.some(e.point(t)-n.getInnerHeight()):e.point(t)<0?h.some(-e.point(t)):h.none()}(e,o,t).fold(function(){return t.situsFromPoint(o.left(),e.point(o))},function(n){return t.scrollBy(0,n),t.situsFromPoint(o.left(),e.point(o)-n)})},Ql={tryUp:i($l,Xl),tryDown:i($l,Kl),ieTryUp:function(e,t){return e.situsFromPoint(t.left(),t.top()-5)},ieTryDown:function(e,t){return e.situsFromPoint(t.left(),t.bottom()+5)},getJumpSize:r(5)},Zl=ir([{none:["message"]},{success:[]},{failedUp:["cell"]},{failedDown:["cell"]}]),ef=function(e){return yt.closest(e,"tr")},tf={verify:function(e,t,n,r,o,i,u){return yt.closest(r,"td,th",u).bind(function(n){return yt.closest(t,"td,th",u).map(function(t){return qe.eq(n,t)?qe.eq(r,n)&&rn(n)===o?i(t):Zl.none("in same cell"):Mn.sharedOne(ef,[n,t]).fold(function(){return function(e,t,n){var r=e.getRect(t),o=e.getRect(n);return o.right>r.left&&o.left<r.right}(e,t,n)?Zl.success():i(t)},function(e){return i(t)})})}).getOr(Zl.none("default"))},cata:function(e,t,n,r,o){return e.fold(t,n,r,o)},adt:Zl},nf={point:z("element","offset"),delta:z("element","deltaOffset"),range:z("element","start","finish"),points:z("begin","end"),text:z("element","text")},rf=(z("ancestor","descendants","element","index"),z("parent","children","element","index")),of=function(e,t){return k(e,i(qe.eq,t))},uf=function(e){return Ye.parent(e).bind(function(t){var n=Ye.children(t);return of(n,e).map(function(r){return rf(t,n,e,r)})})},af=function(e){return"br"===nt.name(e)},cf=function(e,t,n){return t(e,n).bind(function(e){return nt.isText(e)&&0===en.get(e).trim().length?cf(e,t,n):h.some(e)})},lf=function(e,t,n,r){return function(e,t){return Ye.child(e,t).filter(af).orThunk(function(){return Ye.child(e,t-1).filter(af)})}(t,n).bind(function(t){return r.traverse(t).fold(function(){return cf(t,r.gather,e).map(r.relative)},function(e){return uf(e).map(function(e){return gc.on(e.parent(),e.index())})})})},ff=function(e,t,n,o){return(af(t)?function(e,t,n){return n.traverse(t).orThunk(function(){return cf(t,n.gather,e)}).map(n.relative)}(e,t,o):lf(e,t,n,o)).map(function(e){return{start:r(e),finish:r(e)}})},sf=function(e){return tf.cata(e,function(e){return h.none()},function(){return h.none()},function(e){return h.some(nf.point(e,0))},function(e){return h.some(nf.point(e,rn(e)))})},df=_e.detect(),mf=function(e,t,n,r,o,i){return 0===i?h.none():pf(e,t,n,r,o).bind(function(u){var a=e.fromSitus(u),c=tf.verify(e,n,r,a.finish(),a.foffset(),o.failure,t);return tf.cata(c,function(){return h.none()},function(){return h.some(u)},function(u){return qe.eq(n,u)&&0===r?gf(e,n,r,Rl.moveUp,o):mf(e,t,u,0,o,i-1)},function(u){return qe.eq(n,u)&&r===rn(u)?gf(e,n,r,Rl.moveDown,o):mf(e,t,u,rn(u),o,i-1)})})},gf=function(e,t,n,r,o){return El(e,t,n).bind(function(t){return hf(e,o,r(t,Ql.getJumpSize()))})},hf=function(e,t,n){return df.browser.isChrome()||df.browser.isSafari()||df.browser.isFirefox()||df.browser.isEdge()?t.otherRetry(e,n):df.browser.isIE()?t.ieRetry(e,n):h.none()},pf=function(e,t,n,r,o){return El(e,n,r).bind(function(t){return hf(e,o,t)})},vf=function(e,t,n){return function(e,t,n){return e.getSelection().bind(function(r){return ff(t,r.finish(),r.foffset(),n).fold(function(){return h.some(nf.point(r.finish(),r.foffset()))},function(o){var i=e.fromSitus(o),u=tf.verify(e,r.finish(),r.foffset(),i.finish(),i.foffset(),n.failure,t);return sf(u)})})}(e,t,n).bind(function(r){return mf(e,t,r.element(),r.offset(),n,20).map(e.fromSitus)})},bf=function(e,t,n){return bt.ancestor(e,t,n).isSome()},wf=_e.detect(),yf=function(e,t,n,o,i){return yt.closest(o,"td,th",t).bind(function(o){return yt.closest(o,"table",t).bind(function(u){return function(e,t){return bf(e,function(e){return Ye.parent(e).exists(function(e){return qe.eq(e,t)})})}(i,u)?vf(e,t,n).bind(function(e){return yt.closest(e.finish(),"td,th",t).map(function(t){return{start:r(o),finish:r(t),range:r(e)}})}):h.none()})})},xf=function(e,t,n,r,o,i){return wf.browser.isIE()?h.none():i(r,t).orThunk(function(){return yf(e,t,n,r,o).map(function(e){var t=e.range();return ll.response(h.some(gl.makeSitus(t.start(),t.soffset(),t.finish(),t.foffset())),!0)})})},Cf=function(e,t,n,r,o,i,u){return yf(e,n,r,o,i).bind(function(e){return Cl.detect(t,n,e.start(),e.finish(),u)})},Sf=function(e,t){return yt.closest(e,"tr",t).bind(function(e){return yt.closest(e,"table",t).bind(function(n){var r=mt.descendants(n,"tr");return qe.eq(e,r[0])?Vl.seekLeft(n,function(e){return an.last(e).isSome()},t).map(function(e){var t=rn(e);return ll.response(h.some(gl.makeSitus(e,t,e,t)),!0)}):h.none()})})},Rf=function(e,t){return yt.closest(e,"tr",t).bind(function(e){return yt.closest(e,"table",t).bind(function(n){var r=mt.descendants(n,"tr");return qe.eq(e,r[r.length-1])?Vl.seekRight(n,function(e){return an.first(e).isSome()},t).map(function(e){return ll.response(h.some(gl.makeSitus(e,0,e,0)),!0)}):h.none()})})},Tf=function(e,t){return yt.closest(e,"td,th",t)},Nf={down:{traverse:Ye.nextSibling,gather:Vl.after,relative:gc.before,otherRetry:Ql.tryDown,ieRetry:Ql.ieTryDown,failure:tf.adt.failedDown},up:{traverse:Ye.prevSibling,gather:Vl.before,relative:gc.before,otherRetry:Ql.tryUp,ieRetry:Ql.ieTryUp,failure:tf.adt.failedUp}},Ef=z("rows","cols"),Df={mouse:function(e,t,n,r){var o=function(e,t,n,r){var o=h.none(),i=function(){o=h.none()};return{mousedown:function(e){r.clear(t),o=Tf(e.target(),n)},mouseover:function(i){o.each(function(o){r.clear(t),Tf(i.target(),n).each(function(i){er.identify(o,i,n).each(function(n){var u=n.boxes().getOr([]);(u.length>1||1===u.length&&!qe.eq(o,i))&&(r.selectRange(t,u,n.start(),n.finish()),e.selectContents(i))})})})},mouseup:function(){o.each(i)}}}(yl(e),t,n,r);return{mousedown:o.mousedown,mouseover:o.mouseover,mouseup:o.mouseup}},keyboard:function(e,t,n,r){var o=yl(e),u=function(){return r.clear(t),h.none()};return{keydown:function(e,a,c,l,f,s){var d=e.raw().which,m=!0===e.raw().shiftKey;return er.retrieve(t,r.selectedSelector()).fold(function(){return ml.isDown(d)&&m?i(Cf,o,t,n,Nf.down,l,a,r.selectRange):ml.isUp(d)&&m?i(Cf,o,t,n,Nf.up,l,a,r.selectRange):ml.isDown(d)?i(xf,o,n,Nf.down,l,a,Rf):ml.isUp(d)?i(xf,o,n,Nf.up,l,a,Sf):h.none},function(e){var n=function(n){return function(){return Do(n,function(n){return Cl.update(n.rows(),n.cols(),t,e,r)}).fold(function(){return er.getEdges(t,r.firstSelectedSelector(),r.lastSelectedSelector()).map(function(e){var n=ml.isDown(d)||s.isForward(d)?gc.after:gc.before;return o.setRelativeSelection(gc.on(e.first(),0),n(e.table())),r.clear(t),ll.response(h.none(),!0)})},function(e){return h.some(ll.response(h.none(),!0))})}};return ml.isDown(d)&&m?n([Ef(1,0)]):ml.isUp(d)&&m?n([Ef(-1,0)]):s.isBackward(d)&&m?n([Ef(0,-1),Ef(-1,0)]):s.isForward(d)&&m?n([Ef(0,1),Ef(1,0)]):ml.isNavigation(d)&&!1===m?u:h.none})()},keyup:function(e,o,i,u,a){return er.retrieve(t,r.selectedSelector()).fold(function(){var c=e.raw().which;return 0==(!0===e.raw().shiftKey)?h.none():ml.isNavigation(c)?Cl.sync(t,n,o,i,u,a,r.selectRange):h.none()},h.none)}}}},Of=function(e,t){N(t,function(t){ci.remove(e,t)})},Af=function(e){return function(t){ci.add(t,e)}},kf=function(e){return function(t){Of(t,e)}},Pf={byClass:function(e){var t=Af(e.selected()),n=kf([e.selected(),e.lastSelected(),e.firstSelected()]),r=function(t){var r=mt.descendants(t,e.selectedSelector());N(r,n)};return{clear:r,selectRange:function(n,o,i,u){r(n),N(o,t),ci.add(i,e.firstSelected()),ci.add(u,e.lastSelected())},selectedSelector:e.selectedSelector,firstSelectedSelector:e.firstSelectedSelector,lastSelectedSelector:e.lastSelectedSelector}},byAttr:function(e){var t=function(t){at.remove(t,e.selected()),at.remove(t,e.firstSelected()),at.remove(t,e.lastSelected())},n=function(t){at.set(t,e.selected(),"1")},r=function(n){var r=mt.descendants(n,e.selectedSelector());N(r,t)};return{clear:r,selectRange:function(t,o,i,u){r(t),N(o,n),at.set(i,e.firstSelected(),"1"),at.set(u,e.lastSelected(),"1")},selectedSelector:e.selectedSelector,firstSelectedSelector:e.firstSelectedSelector,lastSelectedSelector:e.lastSelectedSelector}}},If=function(e){return!1===ci.has(oe.fromDom(e.target),"ephox-snooker-resizer-bar")},Bf=function(e){return{get:function(){var t=Mu(e);return tr(t,or.selectedSelector()).fold(function(){return void 0===e.selection.getStart()?ar.none():ar.single(e.selection)},function(e){return ar.multiple(e)})}}},Wf=da.each,Mf={addButtons:function(e){var t=[];function n(t){return function(){e.execCommand(t)}}Wf("inserttable tableprops deletetable | cell row column".split(" "),function(n){"|"===n?t.push({text:"-"}):t.push(e.menuItems[n])}),e.addButton("table",{type:"menubutton",title:"Table",menu:t}),e.addButton("tableprops",{title:"Table properties",onclick:n("mceTableProps"),icon:"table"}),e.addButton("tabledelete",{title:"Delete table",onclick:n("mceTableDelete")}),e.addButton("tablecellprops",{title:"Cell properties",onclick:n("mceTableCellProps")}),e.addButton("tablemergecells",{title:"Merge cells",onclick:n("mceTableMergeCells")}),e.addButton("tablesplitcells",{title:"Split cell",onclick:n("mceTableSplitCells")}),e.addButton("tableinsertrowbefore",{title:"Insert row before",onclick:n("mceTableInsertRowBefore")}),e.addButton("tableinsertrowafter",{title:"Insert row after",onclick:n("mceTableInsertRowAfter")}),e.addButton("tabledeleterow",{title:"Delete row",onclick:n("mceTableDeleteRow")}),e.addButton("tablerowprops",{title:"Row properties",onclick:n("mceTableRowProps")}),e.addButton("tablecutrow",{title:"Cut row",onclick:n("mceTableCutRow")}),e.addButton("tablecopyrow",{title:"Copy row",onclick:n("mceTableCopyRow")}),e.addButton("tablepasterowbefore",{title:"Paste row before",onclick:n("mceTablePasteRowBefore")}),e.addButton("tablepasterowafter",{title:"Paste row after",onclick:n("mceTablePasteRowAfter")}),e.addButton("tableinsertcolbefore",{title:"Insert column before",onclick:n("mceTableInsertColBefore")}),e.addButton("tableinsertcolafter",{title:"Insert column after",onclick:n("mceTableInsertColAfter")}),e.addButton("tabledeletecol",{title:"Delete column",onclick:n("mceTableDeleteCol")})},addToolbars:function(e){var t=function(e){var t=e.getParam("table_toolbar",Yu);return""===t||!1===t?[]:v(t)?t.split(/[ ,]/):b(t)?t:[]}(e);t.length>0&&e.addContextToolbar(function(t){return e.dom.is(t,"table")&&e.getBody().contains(t)},t.join(" "))}},_f={addMenuItems:function(e,t){var n=h.none(),r=[],o=[],i=[],u=[],a=function(e){e.disabled(!0)},c=function(e){e.disabled(!1)},l=function(){var e=this;r.push(e),n.fold(function(){a(e)},function(t){c(e)})},f=function(){var e=this;o.push(e),n.fold(function(){a(e)},function(t){c(e)})};e.on("init",function(){e.on("nodechange",function(l){var f=h.from(e.dom.getParent(e.selection.getStart(),"th,td"));(n=f.bind(function(e){var n=oe.fromDom(e);return Rt.table(n).map(function(e){return gr.forMenu(t,e,n)})})).fold(function(){N(r,a),N(o,a),N(i,a),N(u,a)},function(e){N(r,c),N(o,c),N(i,function(t){t.disabled(e.mergable().isNone())}),N(u,function(t){t.disabled(e.unmergable().isNone())})})})});var s=function(e,t,n,r){var o,i,u,a,c,l=r.getEl().getElementsByTagName("table")[0],f=r.isRtl()||"tl-tr"===r.parent().rel;for(l.nextSibling.innerHTML=t+1+" x "+(n+1),f&&(t=9-t),i=0;i<10;i++)for(o=0;o<10;o++)a=l.rows[i].childNodes[o].firstChild,c=(f?o>=t:o<=t)&&i<=n,e.dom.toggleClass(a,"mce-active",c),c&&(u=a);return u.parentNode},d=!1===function(e){return e.getParam("table_grid",!0,"boolean")}(e)?{text:"Table",icon:"table",context:"table",onclick:m("mceInsertTable")}:{text:"Table",icon:"table",context:"table",ariaHideMenu:!0,onclick:function(t){t.aria&&(this.parent().hideAll(),t.stopImmediatePropagation(),e.execCommand("mceInsertTable"))},onshow:function(){s(e,0,0,this.menu.items()[0])},onhide:function(){var t=this.menu.items()[0].getEl().getElementsByTagName("a");e.dom.removeClass(t,"mce-active"),e.dom.addClass(t[0],"mce-active")},menu:[{type:"container",html:function(){var e="";e='<table role="grid" class="mce-grid mce-grid-border" aria-readonly="true">';for(var t=0;t<10;t++){e+="<tr>";for(var n=0;n<10;n++)e+='<td role="gridcell" tabindex="-1"><a id="mcegrid'+(10*t+n)+'" href="#" data-mce-x="'+n+'" data-mce-y="'+t+'"></a></td>';e+="</tr>"}return e+="</table>",e+='<div class="mce-text-center" role="presentation">1 x 1</div>'}(),onPostRender:function(){this.lastX=this.lastY=0},onmousemove:function(t){var n,r,o=t.target;"A"===o.tagName.toUpperCase()&&(n=parseInt(o.getAttribute("data-mce-x"),10),r=parseInt(o.getAttribute("data-mce-y"),10),(this.isRtl()||"tl-tr"===this.parent().rel)&&(n=9-n),n===this.lastX&&r===this.lastY||(s(e,n,r,t.control),this.lastX=n,this.lastY=r))},onclick:function(t){var n=this;"A"===t.target.tagName.toUpperCase()&&(t.preventDefault(),t.stopPropagation(),n.parent().cancel(),e.undoManager.transact(function(){Da(e,n.lastX+1,n.lastY+1)}),e.addVisual())}}]};function m(t){return function(){e.execCommand(t)}}var g={text:"Table properties",context:"table",onPostRender:l,onclick:m("mceTableProps")},p={text:"Delete table",context:"table",onPostRender:l,cmd:"mceTableDelete"},v={text:"Row",context:"table",menu:[{text:"Insert row before",onclick:m("mceTableInsertRowBefore"),onPostRender:f},{text:"Insert row after",onclick:m("mceTableInsertRowAfter"),onPostRender:f},{text:"Delete row",onclick:m("mceTableDeleteRow"),onPostRender:f},{text:"Row properties",onclick:m("mceTableRowProps"),onPostRender:f},{text:"-"},{text:"Cut row",onclick:m("mceTableCutRow"),onPostRender:f},{text:"Copy row",onclick:m("mceTableCopyRow"),onPostRender:f},{text:"Paste row before",onclick:m("mceTablePasteRowBefore"),onPostRender:f},{text:"Paste row after",onclick:m("mceTablePasteRowAfter"),onPostRender:f}]},b={text:"Column",context:"table",menu:[{text:"Insert column before",onclick:m("mceTableInsertColBefore"),onPostRender:f},{text:"Insert column after",onclick:m("mceTableInsertColAfter"),onPostRender:f},{text:"Delete column",onclick:m("mceTableDeleteCol"),onPostRender:f}]},w={separator:"before",text:"Cell",context:"table",menu:[{text:"Cell properties",onclick:m("mceTableCellProps"),onPostRender:f},{text:"Merge cells",onclick:m("mceTableMergeCells"),onPostRender:function(){var e=this;i.push(e),n.fold(function(){a(e)},function(t){e.disabled(t.mergable().isNone())})}},{text:"Split cell",onclick:m("mceTableSplitCells"),onPostRender:function(){var e=this;u.push(e),n.fold(function(){a(e)},function(t){e.disabled(t.unmergable().isNone())})}}]};e.addMenuItem("inserttable",d),e.addMenuItem("tableprops",g),e.addMenuItem("deletetable",p),e.addMenuItem("row",v),e.addMenuItem("column",b),e.addMenuItem("cell",w)}},Lf=function(e,t){return{insertTable:function(t,n){return Da(e,t,n)},setClipboardRows:function(e){return function(e,t){var n=T(e,oe.fromDom);t.set(h.from(n))}(e,t)},getClipboardRows:function(){return function(e){return e.get().fold(function(){},function(e){return T(e,function(e){return e.dom()})})}(t)}}};e.add("table",function(e){var o=oc(e),i=function(e,o){var i=K(["mousedown","mouseover","mouseup","keyup","keydown"],[]),u=h.none(),a=Pf.byAttr(or);return e.on("init",function(c){var l=e.getWin(),f=Mu(e),s=ju(e),d=Df.mouse(l,f,s,a),m=Df.keyboard(l,f,s,a),g=function(t,n){(function(e){return!0===e.raw().shiftKey})(t)&&(n.kill()&&t.kill(),n.selection().each(function(t){var n=vc.relative(t.start(),t.finish()),r=Dc.asLtrRange(l,n);e.selection.setRng(r)}))},p=function(t){var n=w(t);if(n.raw().shiftKey&&ml.isNavigation(n.raw().which)){var r=e.selection.getRng(),o=oe.fromDom(r.startContainer),i=oe.fromDom(r.endContainer);m.keyup(n,o,r.startOffset,i,r.endOffset).each(function(e){g(n,e)})}},v=function(t){var n=w(t);o().each(function(e){e.hideBars()});var r=e.selection.getRng(),i=oe.fromDom(e.selection.getStart()),u=oe.fromDom(r.startContainer),a=oe.fromDom(r.endContainer),c=Gu.directionAt(i).isRtl()?ml.rtl:ml.ltr;m.keydown(n,u,r.startOffset,a,r.endOffset,c).each(function(e){g(n,e)}),o().each(function(e){e.showBars()})},b=function(e){return e.hasOwnProperty("x")&&e.hasOwnProperty("y")},w=function(e){var t=oe.fromDom(e.target),o=function(){e.stopPropagation()},i=function(){e.preventDefault()},u=n(i,o);return{target:r(t),x:r(b(e)?e.x:null),y:r(b(e)?e.y:null),stop:o,prevent:i,kill:u,raw:r(e)}},y=function(e){return 0===e.button},x=function(e){y(e)&&If(e)&&d.mousedown(w(e))},C=function(e){(function(e){return void 0===e.buttons||0!=(1&e.buttons)})(e)&&If(e)&&d.mouseover(w(e))},S=function(e){y(e)&&If(e)&&d.mouseup(w(e))};e.on("mousedown",x),e.on("mouseover",C),e.on("mouseup",S),e.on("keyup",p),e.on("keydown",v),e.on("nodechange",function(){var n=e.selection,r=oe.fromDom(n.getStart()),o=oe.fromDom(n.getEnd());Mn.sharedOne(Rt.table,[r,o]).fold(function(){a.clear(f)},t)}),u=h.some(i({mousedown:x,mouseover:C,mouseup:S,keyup:p,keydown:v}))}),{clear:a.clear,destroy:function(){u.each(function(e){})}}}(e,o.lazyResize),u=fa(e,o.lazyWire),a=Bf(e),c=oo(h.none());return Ia.registerCommands(e,u,i,a,c),hr.registerEvents(e,a,u,i),_f.addMenuItems(e,a),Mf.addButtons(e),Mf.addToolbars(e),e.on("PreInit",function(){e.serializer.addTempAttr(or.firstSelected()),e.serializer.addTempAttr(or.lastSelected())}),$u(e)&&e.on("keydown",function(t){cl.handle(t,e,u,o.lazyWire)}),e.on("remove",function(){o.destroy(),i.destroy()}),Lf(e,c)})}()}});